<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Newflaw - F. Geng</title><link href="http://www.newflaw.com/blog/" rel="alternate"></link><link href="http://www.newflaw.com/blog/feeds/f-geng.atom.xml" rel="self"></link><id>http://www.newflaw.com/blog/</id><updated>2017-09-27T22:39:00+01:00</updated><subtitle>Nature is never flawless</subtitle><entry><title>风城纪事·渣渣</title><link href="http://www.newflaw.com/blog/articles/thoughts/feng-cheng-ji-shi-zha-zha/" rel="alternate"></link><published>2017-09-27T22:39:00+01:00</published><updated>2017-09-27T22:39:00+01:00</updated><author><name>F. Geng</name></author><id>tag:www.newflaw.com,2017-09-27:/blog/articles/thoughts/feng-cheng-ji-shi-zha-zha/</id><summary type="html">&lt;p&gt;“我到底是不是一个渣渣？”&lt;/p&gt;</summary><content type="html">&lt;p&gt;“我到底是不是一个渣渣？”&lt;/p&gt;
&lt;p&gt;[caption id="attachment_1021" align="alignnone" width="548"]&lt;img src="http://www.newflaw.com/blog/wp-content/uploads/2017/09/set2-1024x768.jpg" alt="" width="548" class="size-large wp-image-1021" /&gt; 简单的交集操作："我 &amp;amp; 你"[/caption]&lt;/p&gt;
&lt;!--more--&gt;

&lt;h1&gt;
前言：
&lt;/h1&gt;

&lt;p&gt;通过比较来下定义是一个通用的办法，想象我们有两个集合，“我”集和“你”集。可以抽象的认为，“我”集包含了个体“我”具有的所有品质，相应地可以定义“你”集。接下来我们讨论几个逻辑上存疑的推断，以支持论点”不要因为别人的看似强大而自卑，也不要因为自己的看似渊博而自负。“：
&lt;li&gt;
自卑推断&lt;/li&gt;
&lt;li&gt;
自负推断&lt;/li&gt;
&lt;li&gt;
联合自卑推断&lt;/li&gt;&lt;/p&gt;
&lt;p&gt;[caption id="attachment_1019" align="alignnone" width="584"]&lt;img src="http://www.newflaw.com/blog/wp-content/uploads/2017/09/set1-1024x768.jpg" alt="" width="584" height="438" class="alignnone size-large wp-image-1019" /&gt; 初始韦恩图[/caption]&lt;/p&gt;
&lt;p&gt;[caption id="attachment_1021" align="alignnone" width="548"]&lt;img src="http://www.newflaw.com/blog/wp-content/uploads/2017/09/set2-1024x768.jpg" alt="" width="548" class="size-large wp-image-1021" /&gt; 简单的交集操作："我 &amp;amp; 你"[/caption]&lt;/p&gt;
&lt;h2&gt;
1.自负推断：“你看，我有的这些，他都没有！（看我多厉害！）”
&lt;/h2&gt;

&lt;h3&gt;
注： "&amp;"指交集操作，“|x|”指“x”的度量/大小。"+"指并集操作， ”-“ 指差集操作
&lt;/h3&gt;

&lt;p&gt;在“我”被清楚定义而“你”的定义不明时，我们通过“我”和"你"的交集来估算“你”的大小，也就是通俗意义上的“攀比”。&lt;/p&gt;
&lt;p&gt;也就是说基于假设： |你| 正比于 |我 &amp;amp; 你|，我们可以实现推断： f:|我 &amp;amp; 你| --&amp;gt; |你|， &lt;/p&gt;
&lt;p&gt;[caption id="attachment_1025" align="alignnone" width="584"]&lt;img src="http://www.newflaw.com/blog/wp-content/uploads/2017/09/set7-1024x768.jpg" alt="" width="584" height="438" class="size-large wp-image-1025" /&gt; 通过交集逆推”你“集[/caption]&lt;/p&gt;
&lt;p&gt;又因为 |我 &amp;amp; 你| = |我| - |我 - 你|， 所以实际操作中我们常常直接从 |我 - 你| 出发，实现对 |你| 的估算。&lt;/p&gt;
&lt;p&gt;[caption id="attachment_1028" align="alignnone" width="584"]&lt;img src="http://www.newflaw.com/blog/wp-content/uploads/2017/09/set10-1024x768.jpg" alt="" width="584" height="438" class="size-large wp-image-1028" /&gt; | 我 - 你 | 可以导出 | 我 &amp;amp; 你 |[/caption]&lt;/p&gt;
&lt;p&gt;但是事实上，这个估算不一定成立。因为我们的假设是没有任何保证的（一厢情愿），实际情况中 |我 &amp;amp; 你| 和 |你| 不一定有相关性。&lt;/p&gt;
&lt;p&gt;[caption id="attachment_1026" align="alignnone" width="584"]&lt;img src="http://www.newflaw.com/blog/wp-content/uploads/2017/09/set8-1024x768.jpg" alt="" width="584" height="438" class="size-large wp-image-1026" /&gt; 情景一： ”你“集的确很小&lt;br /&gt;[/caption]&lt;/p&gt;
&lt;p&gt;[caption id="attachment_1027" align="alignnone" width="584"]&lt;img src="http://www.newflaw.com/blog/wp-content/uploads/2017/09/set9-1024x768.jpg" alt="" width="584" height="438" class="size-large wp-image-1027" /&gt; 情景二： 尽管交集很小，但”你“集其实很大[/caption]&lt;/p&gt;
&lt;h2&gt;
2.自卑推断:“你看，你有的这些，我都没有！（看我多渣！）”
&lt;/h2&gt;

&lt;h3&gt;
注：“正比”是一个可逆关系
&lt;/h3&gt;

&lt;p&gt;自卑推断基本上是自负推断的对偶，可以表示为 g:|你 - 我| -&amp;gt; |我|。换句话说，是对“我”的度量不确定的情况下，用“交集”来估算自身的大小。
[caption id="attachment_1030" align="alignnone" width="584"]&lt;img src="http://www.newflaw.com/blog/wp-content/uploads/2017/09/set11-1024x768.jpg" alt="" width="584" height="438" class="size-large wp-image-1030" /&gt; 既可以用交集估算[/caption]&lt;/p&gt;
&lt;p&gt;[caption id="attachment_1031" align="alignnone" width="584"]&lt;img src="http://www.newflaw.com/blog/wp-content/uploads/2017/09/set12-1024x768.jpg" alt="" width="584" height="438" class="size-large wp-image-1031" /&gt; 也可以用差集估算[/caption]&lt;/p&gt;
&lt;p&gt;由于同样的原因，自卑推断也受限于假设 |我 &amp;amp; 你| 正比于 |我|。&lt;/p&gt;
&lt;h2&gt;
3.联合自卑推断：“你看，这些东西，我们都没有！（在座的各位都是渣渣！）”
&lt;/h2&gt;

&lt;p&gt;这个时候我们的注意力在 “(我 + 你)” 的补集上，亦即"全集 - (我 + 你)"，此时我们对”全集“，”我“，”你“三者的大小都没有准确的信息(”全集“包含了所有已知)，但是我们知道”我 + 你“ 所不具备的那些元素。&lt;/p&gt;
&lt;p&gt;可以把该推断写成 u: | 全集 - （我 + 你) | --&amp;gt; ( | 我 | ， | 你 | )&lt;/p&gt;
&lt;p&gt;这个推断利用了以下等式： |全集| = | 全集 - （我 + 你) |  +  |我 + 你|&lt;/p&gt;
&lt;p&gt;[caption id="attachment_1032" align="alignnone" width="584"]&lt;img src="http://www.newflaw.com/blog/wp-content/uploads/2017/09/set13-1024x768.jpg" alt="" width="584" height="438" class="size-large wp-image-1032" /&gt; 差集常常是我们认识世界的直觉[/caption]&lt;/p&gt;
&lt;p&gt;按理说没有地方可以出问题了，但是如果|全集|和 |我 + 你| 同时变大或者变小， 中间的差集大小是可以不变的。也就是说， | 全集 - （我 + 你) | 无法对 |我 + 你| 的大小作出任何保证。&lt;/p&gt;
&lt;h2&gt;
总结： 基于单一指标的观察，尤其是差集的大小(如： |我 - 你| )，常常会导出不可靠的结论。时刻警惕从相对度量”差距“中导出绝对度量的推断。
&lt;/h2&gt;

&lt;h2&gt;
说人话： 不要因为别人的看似强大而自卑，也不要因为自己的看似渊博而自负。只有将注意力合理分配在多个个体上，才能做出可靠的判断。
&lt;/h2&gt;

&lt;p&gt;这篇文章的灵感是来自于ISS项目中对交集运算的使用，更一般说是来自于对 "Sensitivity" 和 "Specificity" 两个指标的理解。通俗的讲，就是基于”攀比/对比“生成的”长处“和”短处“进行的一些常见推断，和常见潜在假设（Implicit Assumption）的梳理。&lt;/p&gt;
&lt;h2&gt;
后记 (胡言乱语)：
&lt;/h2&gt;

&lt;p&gt;有时候会碰上很奇怪的谈话，言语间分明感到“我不想和你说话，你个渣渣”，但是对方又没有主动停下的意思。。。这个时候就很尴尬了。考虑发送者(sender)和接收者(receiver)&lt;/p&gt;
&lt;p&gt;这种情况呢，一般伴随着接收者的莫名其妙。也就是说，接收者完全不相信发送者的“渣渣声明”，但是又不愿意花太多力气去停止这个“渣渣声明”，毕竟如果不是渣渣，谁会在乎是否被声明成了渣渣。换句话说，接收者相信“渣渣声明”与自己是无关的，尽管在表面这个声明是指向自己的。...&lt;/p&gt;
&lt;p&gt;2017年9月26日
剑桥&lt;/p&gt;</content><category term="thoughts"></category><category term="chinese"></category><category term="thoughts"></category></entry><entry><title>DoReMiDo // 哆来咪哆</title><link href="http://www.newflaw.com/blog/articles/thoughts/doremido-chi-lai-mi-chi/" rel="alternate"></link><published>2017-08-09T11:52:00+01:00</published><updated>2017-08-09T11:52:00+01:00</updated><author><name>F. Geng</name></author><id>tag:www.newflaw.com,2017-08-09:/blog/articles/thoughts/doremido-chi-lai-mi-chi/</id><summary type="html">&lt;p&gt;Probably the first proper song I made so far.&lt;/p&gt;</summary><content type="html">&lt;iframe width="100%" height="150" scrolling="no" frameborder="no" src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/337129762&amp;amp;auto_play=false&amp;amp;hide_related=false&amp;amp;show_comments=true&amp;amp;show_user=true&amp;amp;show_reposts=false&amp;amp;visual=true"&gt;&lt;/iframe&gt;

&lt;p&gt;Probably the first proper song I made so far.&lt;/p&gt;
&lt;p&gt;Please suggest a name by commenting if you are inspired! XD&lt;/p&gt;
&lt;p&gt;//&lt;/p&gt;
&lt;p&gt;应给是比较正式的第一首歌。&lt;/p&gt;
&lt;p&gt;有什么好名字记得留言！XD&lt;/p&gt;</content><category term="thoughts"></category><category term="music"></category><category term="thoughts"></category></entry><entry><title>风城纪事·偶遇</title><link href="http://www.newflaw.com/blog/articles/thoughts/feng-cheng-ji-shi-ou-yu/" rel="alternate"></link><published>2017-07-16T21:30:00+01:00</published><updated>2017-07-16T21:30:00+01:00</updated><author><name>F. Geng</name></author><id>tag:www.newflaw.com,2017-07-16:/blog/articles/thoughts/feng-cheng-ji-shi-ou-yu/</id><summary type="html">&lt;p&gt;艾玛正气定神闲地坐在维多利亚式复古电车里欣赏着窗外的云雾，不巧恶魔闯了进来。&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;img src="http://www.newflaw.com/blog/wp-content/uploads/2017/07/doodles1-1024x703.jpg" alt="" width="584" height="401" class="alignnone size-large wp-image-975" /&gt;
&lt;iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="http://music.163.com/outchain/player?type=2&amp;id=39227637&amp;auto=1&amp;height=66"&gt;&lt;/iframe&gt;
&lt;iframe width="100%" height="80" scrolling="no" frameborder="no" src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/226899942&amp;amp;color=ff5500&amp;amp;auto_play=false&amp;amp;hide_related=false&amp;amp;show_comments=true&amp;amp;show_user=true&amp;amp;show_reposts=false"&gt;&lt;/iframe&gt;&lt;/p&gt;
&lt;p&gt;艾玛正气定神闲地坐在维多利亚式复古电车里欣赏着窗外的云雾，不巧恶魔闯了进来。&lt;/p&gt;
&lt;p&gt;恶魔：艾玛，你在哪里？
艾玛：我在曼恩岛上的火车里
恶魔：再好好想想，你在哪里？
艾玛：我在一节摇晃的维多利亚式的复古车厢里。
恶魔：真的吗？你到底在哪里呀？&lt;!--more--&gt;
艾玛：我在开始暑期实习前的短暂放松里？
恶魔：很好，可是你真的在那嘛？
艾玛：我刚刚在SNAEFELL呼啸的寒风和露水笼罩下的餐厅里。
恶魔：是吗？可那是哪里呢？
艾玛：那是一个可以看到七大王国的地方。
恶魔：可那又是哪里？
艾玛：那是我的思绪停留之地。
恶魔：说到这个，你怎么会在这里。
艾玛：因为我在旅行。
恶魔：那我又为什么在这里？
艾玛：因为我在听你写的这首《BATTLE AGAINST A TRUE HERO》。&lt;/p&gt;
&lt;p&gt;F拍完照，我突然想起，这些照片除了被传到社交网站上发个朋友圈，然后就会被尘封起来了。F说，在回忆往昔的时候会翻出来看，但是又在什么时候才会回忆往昔呢？&lt;/p&gt;
&lt;p&gt;究竟，什么东西会被记忆下来呢？此时，此刻；彼时，彼地。前段时间我翻出了小学时候的照片，翻看了几段春游秋游时的视频，其中我的粗口和言语简直匪夷所思不忍直视。更不能忍的是想要偷拍女同学时欲盖弥彰的声明和顾左右而言他。可是，假若这视频没有被翻出，那么这段记忆，又属于谁呢？&lt;/p&gt;
&lt;p&gt;2017年6月23日
曼恩岛&lt;/p&gt;</content><category term="thoughts"></category><category term="chinese"></category><category term="thoughts"></category></entry><entry><title>How to fail your deadline? - Starting learning MySQL thinking you can master it in one day! // 想超时完成任务？来学MySQL就好！</title><link href="http://www.newflaw.com/blog/articles/program/how-to-fail-your-deadline-starting-learning-mysql-thinking-you-can-master-it-in-one-day-xiang-chao-shi-wan-cheng-ren-wu-lai-xue-mysqljiu-hao/" rel="alternate"></link><published>2017-07-10T18:55:00+01:00</published><updated>2017-07-10T18:55:00+01:00</updated><author><name>F. Geng</name></author><id>tag:www.newflaw.com,2017-07-10:/blog/articles/program/how-to-fail-your-deadline-starting-learning-mysql-thinking-you-can-master-it-in-one-day-xiang-chao-shi-wan-cheng-ren-wu-lai-xue-mysqljiu-hao/</id><summary type="html">&lt;p&gt;First published &lt;a href="http://orengogroup.info/2017/07/10/how-to-fail-your-deadline-starting-learning-mysql-and-think-you-can-master-it-in-one-day/"&gt;here&lt;/a&gt;.
[#### 1. How to fail your deadline? - Starting learning MySQL thinking you can master it in one day!]&lt;/p&gt;
&lt;p&gt;Recently, I touched upon MySQL …&lt;/p&gt;</summary><content type="html">&lt;p&gt;First published &lt;a href="http://orengogroup.info/2017/07/10/how-to-fail-your-deadline-starting-learning-mysql-and-think-you-can-master-it-in-one-day/"&gt;here&lt;/a&gt;.
[#### 1. How to fail your deadline? - Starting learning MySQL thinking you can master it in one day!]&lt;/p&gt;
&lt;p&gt;Recently, I touched upon MySQL because I wanted it to be the backend for my incoming Django-based data browser. After 4 days of prolonged fiddling I finally manage to make some notes of its functionality. It is very fast, but equally importantly, very different from Python! The other lesson is that one should allocate enough time for learning when starting a new language (depending on &lt;a href="https://en.wikipedia.org/wiki/Single-linkage_clustering"&gt;single linkage distance&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;Today's blog will go through:
1. Loading a table into MySQL, be it fixed-width or regularly delimited.
2. Create relations between entries.
3. How to deal with errors, and fix your relationship:&lt;/p&gt;
&lt;!--more--&gt;

&lt;h4&gt;Overview:&lt;/h4&gt;
&lt;p&gt;MySQL is a SQL(standard query language), that is specialised for:
1. database management: To create and maintain the structure of a database&lt;br&gt;
2. Data I/O: Retrieval and deposition of data.&lt;/p&gt;
&lt;p&gt;These functions all look good, so I went on firing a "&lt;code&gt;mysql&lt;/code&gt;" shell to try out all different commands it provides, including &lt;code&gt;SELECT&lt;/code&gt;, &lt;code&gt;SHOW&lt;/code&gt;, &lt;code&gt;DROP&lt;/code&gt;, &lt;code&gt;LOAD DATA&lt;/code&gt;. &lt;/p&gt;
&lt;h4&gt;1. Loading a table into MySQL.&lt;/h4&gt;
&lt;p&gt;The original goal was to load a fixed-width flatfile into MySQL to form the original dataset. I used regex to transform the flatfile into a delimited form and load it with the command:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;## Engage a database before doing anything&lt;/span&gt;
&lt;span class="k"&gt;CREATE&lt;/span&gt; &lt;span class="k"&gt;DATABASE&lt;/span&gt; &lt;span class="k"&gt;IF&lt;/span&gt; &lt;span class="k"&gt;NOT&lt;/span&gt; &lt;span class="k"&gt;EXISTS&lt;/span&gt; &lt;span class="n"&gt;TEST&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;USE&lt;/span&gt; &lt;span class="n"&gt;TEST&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="c1"&gt;## Reset the table&lt;/span&gt;
&lt;span class="k"&gt;DROP&lt;/span&gt; &lt;span class="k"&gt;TABLE&lt;/span&gt; &lt;span class="k"&gt;IF&lt;/span&gt; &lt;span class="k"&gt;EXISTS&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;CREATE&lt;/span&gt; &lt;span class="k"&gt;table&lt;/span&gt; &lt;span class="nf"&gt;s35&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
   &lt;span class="n"&gt;domain_id&lt;/span&gt; &lt;span class="kt"&gt;char&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
   &lt;span class="n"&gt;Class&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="c1"&gt;## Note Capital &amp;quot;C&amp;quot; is used to avoid clash with python &amp;quot;class()&amp;quot; keyword&lt;/span&gt;
   &lt;span class="n"&gt;arch&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
   &lt;span class="n"&gt;topo&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
   &lt;span class="n"&gt;homsf&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
   &lt;span class="n"&gt;s35&lt;/span&gt;  &lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
   &lt;span class="n"&gt;s60&lt;/span&gt;  &lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
   &lt;span class="n"&gt;s95&lt;/span&gt;  &lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
   &lt;span class="n"&gt;s100&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
   &lt;span class="n"&gt;s100_seqcnt&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
   &lt;span class="n"&gt;domain_length&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
   &lt;span class="n"&gt;resolution&lt;/span&gt; &lt;span class="kt"&gt;float&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;


&lt;span class="c1"&gt;#### For a regularly delimited file.&lt;/span&gt;
&lt;span class="k"&gt;LOAD&lt;/span&gt; &lt;span class="n"&gt;DATA&lt;/span&gt; &lt;span class="n"&gt;LOCAL&lt;/span&gt; &lt;span class="k"&gt;INFILE&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;/home/shouldsee/Documents/repos/cathdb/cath-domain-list-S35.txt&amp;#39;&lt;/span&gt;
&lt;span class="k"&gt;INTO&lt;/span&gt; &lt;span class="k"&gt;TABLE&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt; 
&lt;span class="n"&gt;FIELDS&lt;/span&gt; &lt;span class="k"&gt;TERMINATED&lt;/span&gt; &lt;span class="k"&gt;by&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;     &amp;#39;&lt;/span&gt; &lt;span class="k"&gt;lines&lt;/span&gt; &lt;span class="k"&gt;terminated&lt;/span&gt; &lt;span class="k"&gt;by&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;\n&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="c1"&gt;#### If however you got fixed-width CATH CLF.&lt;/span&gt;
&lt;span class="k"&gt;LOAD&lt;/span&gt; &lt;span class="n"&gt;DATA&lt;/span&gt; &lt;span class="n"&gt;LOCAL&lt;/span&gt; &lt;span class="k"&gt;INFILE&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;/home/shouldsee/Documents/repos/cathdb/cath-domain-list-S35-v4_1_0.txt&amp;#39;&lt;/span&gt; 
&lt;span class="k"&gt;INTO&lt;/span&gt; &lt;span class="k"&gt;TABLE&lt;/span&gt; &lt;span class="nf"&gt;s35&lt;/span&gt;
&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;@&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="kt"&gt;SET&lt;/span&gt; &lt;span class="n"&gt;domain_id&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nf"&gt;TRIM&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nf"&gt;SUBSTR&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;@&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt;
    &lt;span class="n"&gt;Class&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nf"&gt;TRIM&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nf"&gt;SUBSTR&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;@&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt;
    &lt;span class="n"&gt;arch&lt;/span&gt;  &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nf"&gt;TRIM&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nf"&gt;SUBSTR&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;@&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;14&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;19&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt;
    &lt;span class="n"&gt;topo&lt;/span&gt;  &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nf"&gt;TRIM&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nf"&gt;SUBSTR&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;@&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt;
    &lt;span class="n"&gt;homsf&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nf"&gt;TRIM&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nf"&gt;SUBSTR&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;@&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;26&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;31&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt;
    &lt;span class="n"&gt;s35&lt;/span&gt;   &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nf"&gt;TRIM&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nf"&gt;SUBSTR&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;@&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;32&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;37&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt;
    &lt;span class="n"&gt;s60&lt;/span&gt;   &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nf"&gt;TRIM&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nf"&gt;SUBSTR&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;@&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;38&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;43&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt;
    &lt;span class="n"&gt;s95&lt;/span&gt;   &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nf"&gt;TRIM&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nf"&gt;SUBSTR&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;@&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;44&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;49&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt;
    &lt;span class="n"&gt;s100&lt;/span&gt;  &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nf"&gt;TRIM&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nf"&gt;SUBSTR&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;@&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;55&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt;
    &lt;span class="n"&gt;s100_seqcnt&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nf"&gt;TRIM&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nf"&gt;SUBSTR&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;@&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;56&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;61&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt;
    &lt;span class="n"&gt;domain_length&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nf"&gt;TRIM&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nf"&gt;SUBSTR&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;@&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;62&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;67&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt;
    &lt;span class="n"&gt;resolution&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nf"&gt;TRIM&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nf"&gt;SUBSTR&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;@&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;68&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;73&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;

&lt;span class="k"&gt;SELECT&lt;/span&gt; &lt;span class="n"&gt;domain_id&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;arch&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;topo&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;s35&lt;/span&gt; &lt;span class="k"&gt;from&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt; &lt;span class="k"&gt;limit&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;mysql&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="k"&gt;select&lt;/span&gt; &lt;span class="n"&gt;domain_id&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;arch&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;topo&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;s35&lt;/span&gt; &lt;span class="k"&gt;from&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt; &lt;span class="k"&gt;limit&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; 
&lt;span class="o"&gt;+----------+-------+------+------+-------+------+&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;domain_id&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;Class&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;arch&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;topo&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;  &lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="o"&gt;+----------+-------+------+------+-------+------+&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="n"&gt;oaiA00&lt;/span&gt;  &lt;span class="o"&gt;|&lt;/span&gt;     &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;   &lt;span class="mi"&gt;10&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="mi"&gt;10&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="n"&gt;frhA01&lt;/span&gt;  &lt;span class="o"&gt;|&lt;/span&gt;     &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;   &lt;span class="mi"&gt;10&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="mi"&gt;10&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="n"&gt;oksA00&lt;/span&gt;  &lt;span class="o"&gt;|&lt;/span&gt;     &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;   &lt;span class="mi"&gt;10&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="mi"&gt;10&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="mi"&gt;3&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="n"&gt;un2B00&lt;/span&gt;  &lt;span class="o"&gt;|&lt;/span&gt;     &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;   &lt;span class="mi"&gt;10&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="mi"&gt;10&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="n"&gt;cukA03&lt;/span&gt;  &lt;span class="o"&gt;|&lt;/span&gt;     &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;   &lt;span class="mi"&gt;10&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="mi"&gt;10&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="mi"&gt;5&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="o"&gt;+----------+-------+------+------+-------+------+&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;ul&gt;
&lt;li&gt;Note that raw &lt;a href="http://download.cathdb.info/cath/releases/latest-release/cath-classification-data/README-cath-list-file-format.txt"&gt;CATH CLF files&lt;/a&gt; are fixed-width.&lt;/li&gt;
&lt;li&gt;In case you are not familiar with the organisation of CATH, each "Class" node branches into "Architecture(arch)" children nodes, which in turn branches into "Topology(topo)" children nodes, so on and so forth. &lt;a href="http://wiki.cathdb.info/wiki-beta/doku.php?id=faq"&gt;CATH FAQ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Original "cath-domain-list-S35.txt" can be downloaded from &lt;a href="http://download.cathdb.info/cath/releases/all-releases/v4_1_0/cath-classification-data/cath-domain-list-S35-v4_1_0.txt"&gt;CATH&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Now we have a MySQL table containing all S35 representative structures (S35rep), which allows me to filter the table with some criteria. such as:
1. "&lt;code&gt;SELECT * FROM s35 WHERE Class=1;&lt;/code&gt;" : This will give you all Class 1 S35rep's (You should get 4645 rows).
2. "&lt;code&gt;SELECT * FROM s35 WHERE resolution&amp;lt;1.0;&lt;/code&gt;" : This should give all s35rep with a structual resolution &amp;lt; 1.0 (183 rows)&lt;/p&gt;
&lt;h4&gt;2. Create relations between entries.&lt;/h4&gt;
&lt;p&gt;But there is something I can not fulfill using this structure: Some homologous family (homsf) will have a large number of s35rep (&amp;gt;100) whereas most homsf's will only have several (&amp;lt;5). So it is desirable to filter out the big homsf's only. For example, to count the s35rep in 1.10.8.10, just issue &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;SELECT COUNT(*) FROM s35 WHERE (Class,arch,topo,homsf)=(1,10,8,10);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;And it should return a table saying you got 53 entries, which should all be s35rep's. The problem is: &lt;strong&gt;where should we store this number?&lt;/strong&gt; We can certainly add a "s35_seqcnt" column into the "s35" table and set all s35rep in (1,10,8,10) to have a "s35_seqcnt" of 53, but careful readers must feel dangerous with this approach, reasons are:
1. All entries in "s35" table represent s35rep nodes. From this perspective, any s35rep should only have a s35_count of 1, which refers to itself. 
2. Every time this number changes, (say one s35rep is removed), we will need to update all ~50 entries with the new value (say 52).&lt;/p&gt;
&lt;p&gt;Think about it, s35seq_cnt is a property of homsf, not s35rep itself. If we had a homsf node representing (1,10,8,10), we could have easily set its s35seq_cnt field to be 53, solving both problems at once. Luckily, MySQL is also known as relational database, which means it is built to store relationship. In other words, we can store not only values (e.g: integers,floats,strings), but also cursors to other entries. For this hypothetical homsf node (1,10,8,10), we can actually store a list of cursors pointing to all 53 s35rep's contained within it. &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;DROP&lt;/span&gt; &lt;span class="k"&gt;TABLE&lt;/span&gt; &lt;span class="k"&gt;IF&lt;/span&gt; &lt;span class="k"&gt;EXISTS&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;CREATE&lt;/span&gt; &lt;span class="k"&gt;TABLE&lt;/span&gt; &lt;span class="nf"&gt;homsf&lt;/span&gt;
  &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt; &lt;span class="kt"&gt;INT&lt;/span&gt; &lt;span class="kp"&gt;AUTO_INCREMENT&lt;/span&gt; &lt;span class="k"&gt;PRIMARY&lt;/span&gt; &lt;span class="k"&gt;KEY&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="c1"&gt;### Set an index for cursor in the future&lt;/span&gt;
  &lt;span class="n"&gt;s35_count&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="c1"&gt;## This is new!&lt;/span&gt;
  &lt;span class="n"&gt;Class&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="n"&gt;arch&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="n"&gt;topo&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="n"&gt;homsf&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="c1"&gt;### For homsf, we don&amp;#39;t need index from s35 onwards, but we keep these fields to allow for easier manipulation.&lt;/span&gt;
  &lt;span class="n"&gt;s35&lt;/span&gt;  &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="k"&gt;DEFAULT&lt;/span&gt; &lt;span class="no"&gt;NULL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="n"&gt;s60&lt;/span&gt;  &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="k"&gt;DEFAULT&lt;/span&gt; &lt;span class="no"&gt;NULL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="n"&gt;s95&lt;/span&gt;  &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="k"&gt;DEFAULT&lt;/span&gt; &lt;span class="no"&gt;NULL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="n"&gt;s100&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="k"&gt;DEFAULT&lt;/span&gt; &lt;span class="no"&gt;NULL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="n"&gt;domain_length&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="k"&gt;DEFAULT&lt;/span&gt; &lt;span class="no"&gt;NULL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="n"&gt;resolution&lt;/span&gt; &lt;span class="kt"&gt;float&lt;/span&gt; &lt;span class="k"&gt;DEFAULT&lt;/span&gt; &lt;span class="no"&gt;NULL&lt;/span&gt;
  &lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="c1"&gt;### Insert distinct entries into homsf.&lt;/span&gt;
&lt;span class="c1"&gt;### Since we set &amp;quot;id&amp;quot; to be AUTO_INCREMENT, we don&amp;#39;t need to assign it since it will be auto-generated&lt;/span&gt;
&lt;span class="k"&gt;INSERT&lt;/span&gt; &lt;span class="k"&gt;INTO&lt;/span&gt; &lt;span class="nf"&gt;homsf&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;arch&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;topo&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
   &lt;span class="k"&gt;SELECT&lt;/span&gt; &lt;span class="k"&gt;DISTINCT&lt;/span&gt; &lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;arch&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;topo&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;homsf&lt;/span&gt; &lt;span class="k"&gt;FROM&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Now we would have a table containing all 2737 homsf's, but we have yet to establish the relation between 'homsf' and 's35'. We will use the "id" column of homsf since it is the indexed primary key, which allows for fast lookup. We will:
1. Create a "homsf_id" column in s35 to store its parental homsf node's id.
2. Fill this "homsf_id" using a for loop.
3. Add a foreign key constraint to this column. &lt;/p&gt;
&lt;p&gt;In fact, step 1,2 would suffice to specify the relation. Doing step 3 is only for maintainence purpose and constrain any future modification towards the tables, which is essentially a built-in test that every furture version of database has to pass. Though at beginning constraints is very annoying and throws many errors like:
1. ERROR 1215 (HY000): Cannot add foreign key constraint  (Oh gosh I want to add a constraint!!! Please let me do it!!! Plz!!!)
2. Error Code: 1452. Cannot add or update a child row: a foreign key constraint fails (Oh you evil constraint! Let go of my table!!! I need to modify it!!! I need to drop it!!! Now!!! Here!!!)
3. ...&lt;/p&gt;
&lt;h4&gt;3. How to deal with errors, and fix your relationship:&lt;/h4&gt;
&lt;p&gt;Errors can be very, very annoying and could ruin hours and hours. However, once you understand how it works, these errors suddenly become useful indications that alert you of the potential hazard within commands you've just thrown upon MySQL. This is strictly speaking not a TDD example, since the test is not written for development but merely for maintaining the integrity of the database. Nevertheless, to understand the conept of "Test" on its own is essential to move on to the idea of TDD.&lt;/p&gt;
&lt;p&gt;Now let's implement the stated operations in MySQL.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;### We split these ADD COLUMN commands since they might throw error if homsf_id already exists, but it would require custom procedure to avert so is not included here.&lt;/span&gt;
&lt;span class="k"&gt;ALTER&lt;/span&gt; &lt;span class="k"&gt;TABLE&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt; 
   &lt;span class="k"&gt;ADD&lt;/span&gt; &lt;span class="k"&gt;COLUMN&lt;/span&gt; &lt;span class="n"&gt;homsf_id&lt;/span&gt; &lt;span class="kt"&gt;INT&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;


&lt;span class="c1"&gt;### Fill s35.homsf_id with correct cursors to homsf.id&lt;/span&gt;
&lt;span class="c1"&gt;### This should only be executed if every s35 can find a homsf. One way to ensure this condition is to create a fresh homsf table from s35. Other approaches with INSERT should be possible.&lt;/span&gt;

&lt;span class="k"&gt;UPDATE&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;
  &lt;span class="k"&gt;LEFT&lt;/span&gt; &lt;span class="k"&gt;JOIN&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt; 
  &lt;span class="k"&gt;ON&lt;/span&gt;  &lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;arch&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;topo&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;arch&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;topo&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="kt"&gt;SET&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;homsf_id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="c1"&gt;### Impose the foreign key constraint.&lt;/span&gt;
&lt;span class="k"&gt;ALTER&lt;/span&gt; &lt;span class="k"&gt;TABLE&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;
   &lt;span class="k"&gt;ADD&lt;/span&gt; &lt;span class="k"&gt;CONSTRAINT&lt;/span&gt; &lt;span class="n"&gt;homsf_fk&lt;/span&gt;
   &lt;span class="k"&gt;FOREIGN&lt;/span&gt; &lt;span class="k"&gt;KEY&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;homsf_id&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
   &lt;span class="k"&gt;REFERENCES&lt;/span&gt; &lt;span class="nf"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; 

&lt;span class="k"&gt;SELECT&lt;/span&gt; &lt;span class="nf"&gt;COUNT&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;FROM&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="c1"&gt;### Confirm homsf does not change size&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;It is useful to simulate a 1452 error to illustrate how to debug a foreign key.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;### Temporarily remove the foreign key.&lt;/span&gt;
&lt;span class="k"&gt;ALTER&lt;/span&gt; &lt;span class="k"&gt;TABLE&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;
   &lt;span class="k"&gt;DROP&lt;/span&gt; &lt;span class="k"&gt;FOREIGN&lt;/span&gt; &lt;span class="k"&gt;KEY&lt;/span&gt; &lt;span class="n"&gt;homsf_fk&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="c1"&gt;### Artificially damage the table&lt;/span&gt;
&lt;span class="k"&gt;DELETE&lt;/span&gt; &lt;span class="k"&gt;FROM&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt;
  &lt;span class="k"&gt;WHERE&lt;/span&gt; &lt;span class="n"&gt;id&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="c1"&gt;###&lt;/span&gt;
&lt;span class="k"&gt;UPDATE&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;
  &lt;span class="kt"&gt;SET&lt;/span&gt; &lt;span class="n"&gt;homsf_id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1234&lt;/span&gt;
  &lt;span class="k"&gt;WHERE&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;homsf_id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="c1"&gt;### NEVER do this to a productive database!!&lt;/span&gt;
&lt;span class="k"&gt;UPDATE&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;
  &lt;span class="kt"&gt;SET&lt;/span&gt; &lt;span class="n"&gt;homsf_id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1234567&lt;/span&gt;
  &lt;span class="k"&gt;WHERE&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;homsf_id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="c1"&gt;### Attempt to impose the foreign key constraint.&lt;/span&gt;
&lt;span class="k"&gt;ALTER&lt;/span&gt; &lt;span class="k"&gt;TABLE&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;
   &lt;span class="k"&gt;ADD&lt;/span&gt; &lt;span class="k"&gt;CONSTRAINT&lt;/span&gt; &lt;span class="n"&gt;homsf_fk&lt;/span&gt;
   &lt;span class="k"&gt;FOREIGN&lt;/span&gt; &lt;span class="k"&gt;KEY&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;homsf_id&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
   &lt;span class="k"&gt;REFERENCES&lt;/span&gt; &lt;span class="nf"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Commands above should throw a 1452:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;ERROR&lt;/span&gt; &lt;span class="mi"&gt;1452&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;23000&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt; &lt;span class="n"&gt;Cannot&lt;/span&gt; &lt;span class="k"&gt;add&lt;/span&gt; &lt;span class="k"&gt;or&lt;/span&gt; &lt;span class="k"&gt;update&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;child&lt;/span&gt; &lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="k"&gt;foreign&lt;/span&gt; &lt;span class="k"&gt;key&lt;/span&gt; &lt;span class="k"&gt;constraint&lt;/span&gt; &lt;span class="nf"&gt;fails&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="ss"&gt;`TEST`&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="ss"&gt;`#sql-78c0_66a`&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;CONSTRAINT&lt;/span&gt; &lt;span class="ss"&gt;`homsf_fk`&lt;/span&gt; &lt;span class="k"&gt;FOREIGN&lt;/span&gt; &lt;span class="k"&gt;KEY&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="ss"&gt;`homsf_id`&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;REFERENCES&lt;/span&gt; &lt;span class="ss"&gt;`homsf`&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="ss"&gt;`id`&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We can find out which key is missing with SELECT ... WHERE ...NOT IN. But note this will NOT report that homsf_id=2 has been redirected to homsf_id=1234 !!&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;SELECT&lt;/span&gt; &lt;span class="k"&gt;DISTINCT&lt;/span&gt; &lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;arch&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;topo&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;homsf_id&lt;/span&gt; &lt;span class="k"&gt;FROM&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;
   &lt;span class="k"&gt;WHERE&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;homsf_id&lt;/span&gt; &lt;span class="k"&gt;NOT&lt;/span&gt; &lt;span class="k"&gt;IN&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;SELECT&lt;/span&gt; &lt;span class="n"&gt;id&lt;/span&gt; &lt;span class="k"&gt;FROM&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="k"&gt;UPDATE&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;
  &lt;span class="k"&gt;LEFT&lt;/span&gt; &lt;span class="k"&gt;JOIN&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt; 
  &lt;span class="k"&gt;ON&lt;/span&gt;  &lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;arch&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;topo&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;arch&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;topo&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;+-------+------+------+-------+----------+&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;Class&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;arch&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;topo&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;homsf_id&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="o"&gt;+-------+------+------+-------+----------+&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt;     &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;   &lt;span class="mi"&gt;10&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="mi"&gt;10&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;        &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt;     &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;   &lt;span class="mi"&gt;10&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="mi"&gt;40&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;  &lt;span class="mi"&gt;1234567&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="o"&gt;+-------+------+------+-------+----------+&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;By inspection, we found homsf_id 1 and 1234567 is not referring to any existing homsf.id, perventing us from installing a constraint. So we might consider create new homsf to accommodate these s35 entries. But wait a minute, we don't want to create new homsf that coincide with an existing homsf! We can ensure this by trying to update homsf_id according to existing homsf table.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;#### Save the sub-table with failed keys to a temp table.&lt;/span&gt;
&lt;span class="k"&gt;DROP&lt;/span&gt; &lt;span class="k"&gt;TABLE&lt;/span&gt; &lt;span class="k"&gt;IF&lt;/span&gt; &lt;span class="k"&gt;EXISTS&lt;/span&gt; &lt;span class="n"&gt;temp&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;CREATE&lt;/span&gt; &lt;span class="k"&gt;TABLE&lt;/span&gt; &lt;span class="n"&gt;temp&lt;/span&gt;
&lt;span class="k"&gt;SELECT&lt;/span&gt; &lt;span class="k"&gt;DISTINCT&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="k"&gt;FROM&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;
   &lt;span class="k"&gt;WHERE&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;homsf_id&lt;/span&gt; &lt;span class="k"&gt;NOT&lt;/span&gt; &lt;span class="k"&gt;IN&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;SELECT&lt;/span&gt; &lt;span class="n"&gt;id&lt;/span&gt; &lt;span class="k"&gt;FROM&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="c1"&gt;#### Dump the proposed fix into a table `temp_fix`&lt;/span&gt;
&lt;span class="k"&gt;DROP&lt;/span&gt; &lt;span class="k"&gt;TABLE&lt;/span&gt; &lt;span class="k"&gt;IF&lt;/span&gt; &lt;span class="k"&gt;EXISTS&lt;/span&gt; &lt;span class="n"&gt;temp_fix&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;CREATE&lt;/span&gt; &lt;span class="k"&gt;TABLE&lt;/span&gt; &lt;span class="n"&gt;temp_fix&lt;/span&gt;
&lt;span class="k"&gt;SELECT&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="n"&gt;homsf_id&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;fixed_homsf_id&lt;/span&gt; &lt;span class="k"&gt;FROM&lt;/span&gt; &lt;span class="n"&gt;temp&lt;/span&gt; &lt;span class="k"&gt;AS&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;
  &lt;span class="k"&gt;LEFT&lt;/span&gt; &lt;span class="k"&gt;JOIN&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt; 
  &lt;span class="k"&gt;ON&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;arch&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;topo&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;arch&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;topo&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="c1"&gt;####&lt;/span&gt;
&lt;span class="k"&gt;SELECT&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="k"&gt;FROM&lt;/span&gt; &lt;span class="n"&gt;temp_fix&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We can see that MySQL proposed a valid change for 58th s35 but NULL for the rest. We can apply the proposed update, and reinstall the foreign key constraint.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;UPDATE&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt; 
  &lt;span class="k"&gt;JOIN&lt;/span&gt; &lt;span class="n"&gt;temp_fix&lt;/span&gt; &lt;span class="k"&gt;ON&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;temp_fix&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;
  &lt;span class="kt"&gt;SET&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;homsf_id&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;temp_fix&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fixed_homsf_id&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;ALTER&lt;/span&gt; &lt;span class="k"&gt;TABLE&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;
   &lt;span class="k"&gt;ADD&lt;/span&gt; &lt;span class="k"&gt;CONSTRAINT&lt;/span&gt; &lt;span class="n"&gt;homsf_fk&lt;/span&gt;
   &lt;span class="k"&gt;FOREIGN&lt;/span&gt; &lt;span class="k"&gt;KEY&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;homsf_id&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
   &lt;span class="k"&gt;REFERENCES&lt;/span&gt; &lt;span class="nf"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;  
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;At first glance, one would expect foreign key to fail agian, because we know some homsf_id was updated to NULL, which is not withinse homsf.id. However, a NULL does not constitue a violation to foregin key constraint. To illustrate in more detail:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;SELECT&lt;/span&gt; &lt;span class="nf"&gt;COUNT&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;FROM&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt; &lt;span class="k"&gt;WHERE&lt;/span&gt; &lt;span class="n"&gt;homsf_id&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt; &lt;span class="no"&gt;NULL&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="c1"&gt;## returns 53&lt;/span&gt;
&lt;span class="k"&gt;SELECT&lt;/span&gt; &lt;span class="nf"&gt;COUNT&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;FROM&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt; 
  &lt;span class="k"&gt;WHERE&lt;/span&gt; &lt;span class="n"&gt;homsf_id&lt;/span&gt; &lt;span class="k"&gt;IS&lt;/span&gt; &lt;span class="no"&gt;NULL&lt;/span&gt; 
  &lt;span class="k"&gt;AND&lt;/span&gt; &lt;span class="n"&gt;homsf_id&lt;/span&gt; &lt;span class="k"&gt;IN&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;SELECT&lt;/span&gt; &lt;span class="n"&gt;id&lt;/span&gt; &lt;span class="k"&gt;FROM&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="c1"&gt;## Returns 0&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We see that homsf_id=NULL is indeed not considered within the homsf.id. We conclude foreign key constraint allows exception only if the expcetion is NULL.&lt;/p&gt;
&lt;p&gt;Recall that we redirected homsf_id=2 to homsf_id=1234 when destroying the database. Note this was not fixed during the procedure above. We can compare entries from s35 and from homsf&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;SELECT&lt;/span&gt; &lt;span class="k"&gt;DISTINCT&lt;/span&gt; &lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;arch&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;topo&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;homsf_id&lt;/span&gt;
   &lt;span class="k"&gt;FROM&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt; &lt;span class="k"&gt;WHERE&lt;/span&gt; &lt;span class="n"&gt;homsf_id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1234&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;SELECT&lt;/span&gt; &lt;span class="k"&gt;DISTINCT&lt;/span&gt; &lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;arch&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;topo&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt; &lt;span class="k"&gt;AS&lt;/span&gt; &lt;span class="n"&gt;homsf_id&lt;/span&gt;
   &lt;span class="k"&gt;FROM&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt; &lt;span class="k"&gt;WHERE&lt;/span&gt; &lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1234&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Result:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;mysql&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="k"&gt;SELECT&lt;/span&gt; &lt;span class="k"&gt;DISTINCT&lt;/span&gt; &lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;arch&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;topo&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;homsf_id&lt;/span&gt;
    &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;    &lt;span class="k"&gt;FROM&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt; &lt;span class="k"&gt;WHERE&lt;/span&gt; &lt;span class="n"&gt;homsf_id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1234&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="o"&gt;+-------+------+------+-------+------+----------+&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;Class&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;arch&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;topo&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;id&lt;/span&gt;   &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;homsf_id&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="o"&gt;+-------+------+------+-------+------+----------+&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt;     &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;   &lt;span class="mi"&gt;10&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="mi"&gt;20&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;   &lt;span class="mi"&gt;54&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;     &lt;span class="mi"&gt;1234&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt;     &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;   &lt;span class="mi"&gt;10&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="mi"&gt;20&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;   &lt;span class="mi"&gt;55&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;     &lt;span class="mi"&gt;1234&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt;     &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;   &lt;span class="mi"&gt;10&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="mi"&gt;20&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;   &lt;span class="mi"&gt;56&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;     &lt;span class="mi"&gt;1234&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt;     &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;   &lt;span class="mi"&gt;10&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="mi"&gt;20&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;   &lt;span class="mi"&gt;57&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;     &lt;span class="mi"&gt;1234&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt;     &lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;   &lt;span class="mi"&gt;60&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;   &lt;span class="mi"&gt;40&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;  &lt;span class="mi"&gt;1330&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="mi"&gt;7906&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;     &lt;span class="mi"&gt;1234&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="o"&gt;+-------+------+------+-------+------+----------+&lt;/span&gt;
&lt;span class="mi"&gt;5&lt;/span&gt; &lt;span class="n"&gt;rows&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="kt"&gt;set&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;00&lt;/span&gt; &lt;span class="n"&gt;sec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;mysql&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="k"&gt;SELECT&lt;/span&gt; &lt;span class="k"&gt;DISTINCT&lt;/span&gt; &lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;arch&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;topo&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt; &lt;span class="k"&gt;AS&lt;/span&gt; &lt;span class="n"&gt;homsf_id&lt;/span&gt;
    &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;    &lt;span class="k"&gt;FROM&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt; &lt;span class="k"&gt;WHERE&lt;/span&gt; &lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1234&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="o"&gt;+-------+------+------+-------+----------+&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;Class&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;arch&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;topo&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;homsf_id&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="o"&gt;+-------+------+------+-------+----------+&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt;     &lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;   &lt;span class="mi"&gt;60&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;   &lt;span class="mi"&gt;40&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;  &lt;span class="mi"&gt;1330&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;     &lt;span class="mi"&gt;1234&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="o"&gt;+-------+------+------+-------+----------+&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="kt"&gt;set&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;01&lt;/span&gt; &lt;span class="n"&gt;sec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Some homsf_id is clearly pointing to the wrong homsf entry, without breaking the foregin key constraint, which render the foregin key meaningless. Think about it, if we want to access the homsf_index of a given s35 (id=54), should we:
    1. query the s35 table at (Class,arch,topo,homsf) or
    2. query the homsf entry as specified homsf_id '1234' ?  &lt;/p&gt;
&lt;p&gt;With the first approach , query returns 1.10.8.20, whereas with the second approach, query returns 2.60.40.1330. How should we resolve such conflict? Obviously, if we were to enjoy the privlege of foreign key, we should keep the result from second approach. Why? Because we don't even need foreign key in the first approach! &lt;/p&gt;
&lt;p&gt;In reality, however, one would prefer to avoid generating such conflict in the first place, which can be achieved by dropping the (Class, arch, topo, homsf) columns from s35 table, effectively rendering first approach inviable and forcing the second approach. We will not expand the full implementation here and please feel free to practice it.&lt;/p&gt;
&lt;h4&gt;Sidenotes:&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;NULL or NOT NULL, this is a question:&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;​Recall we updated some homsf_id to NULL in s35 when attempting the fix. This is only possible if the homsf_id column is nullable. We can check the column property by calling
  &lt;code&gt;sql
  SHOW COLUMNS FROM s35;&lt;/code&gt;
  And check the "Null" column of the output.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;DROP TABLE IF NOT EXISTS: 
  This command may not work on some version of SQL. It is quite handy to append "if not exists" to avoid error, but unfortunately it is not available for commands like ADD COLUMN, DROP COLUMN.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Cross database FOREIGN KEY error:&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;When attempting to drop a database that is referred by other database, one would raise ERROR 1217 (23000)[markdown]&lt;/p&gt;
&lt;p&gt;[#### 1. How to fail your deadline? - Starting learning MySQL thinking you can master it in one day!]&lt;/p&gt;
&lt;p&gt;Recently, I touched upon MySQL because I wanted it to be the backend for my incoming Django-based data browser. After 4 days of prolonged fiddling I finally manage to make some notes of its functionality. It is very fast, but equally importantly, very different from Python! The other lesson is that one should allocate enough time for learning when starting a new language (depending on &lt;a href="https://en.wikipedia.org/wiki/Single-linkage_clustering"&gt;single linkage distance&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;Today's blog will go through:
1. Loading a table into MySQL, be it fixed-width or regularly delimited.
2. Create relations between entries.
3. How to deal with errors, and fix your relationship:&lt;/p&gt;
&lt;!--more--&gt;

&lt;h4&gt;Overview:&lt;/h4&gt;
&lt;p&gt;MySQL is a SQL(standard query language), that is specialised for:
1. database management: To create and maintain the structure of a database&lt;br&gt;
2. Data I/O: Retrieval and deposition of data.&lt;/p&gt;
&lt;p&gt;These functions all look good, so I went on firing a "&lt;code&gt;mysql&lt;/code&gt;" shell to try out all different commands it provides, including &lt;code&gt;SELECT&lt;/code&gt;, &lt;code&gt;SHOW&lt;/code&gt;, &lt;code&gt;DROP&lt;/code&gt;, &lt;code&gt;LOAD DATA&lt;/code&gt;. &lt;/p&gt;
&lt;h4&gt;1. Loading a table into MySQL.&lt;/h4&gt;
&lt;p&gt;The original goal was to load a fixed-width flatfile into MySQL to form the original dataset. I used regex to transform the flatfile into a delimited form and load it with the command:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;## Engage a database before doing anything&lt;/span&gt;
&lt;span class="k"&gt;CREATE&lt;/span&gt; &lt;span class="k"&gt;DATABASE&lt;/span&gt; &lt;span class="k"&gt;IF&lt;/span&gt; &lt;span class="k"&gt;NOT&lt;/span&gt; &lt;span class="k"&gt;EXISTS&lt;/span&gt; &lt;span class="n"&gt;TEST&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;USE&lt;/span&gt; &lt;span class="n"&gt;TEST&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="c1"&gt;## Reset the table&lt;/span&gt;
&lt;span class="k"&gt;DROP&lt;/span&gt; &lt;span class="k"&gt;TABLE&lt;/span&gt; &lt;span class="k"&gt;IF&lt;/span&gt; &lt;span class="k"&gt;EXISTS&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;CREATE&lt;/span&gt; &lt;span class="k"&gt;table&lt;/span&gt; &lt;span class="nf"&gt;s35&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
   &lt;span class="n"&gt;domain_id&lt;/span&gt; &lt;span class="kt"&gt;char&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
   &lt;span class="n"&gt;Class&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="c1"&gt;## Note Capital &amp;quot;C&amp;quot; is used to avoid clash with python &amp;quot;class()&amp;quot; keyword&lt;/span&gt;
   &lt;span class="n"&gt;arch&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
   &lt;span class="n"&gt;topo&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
   &lt;span class="n"&gt;homsf&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
   &lt;span class="n"&gt;s35&lt;/span&gt;  &lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
   &lt;span class="n"&gt;s60&lt;/span&gt;  &lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
   &lt;span class="n"&gt;s95&lt;/span&gt;  &lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
   &lt;span class="n"&gt;s100&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
   &lt;span class="n"&gt;s100_seqcnt&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
   &lt;span class="n"&gt;domain_length&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
   &lt;span class="n"&gt;resolution&lt;/span&gt; &lt;span class="kt"&gt;float&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;


&lt;span class="c1"&gt;#### For a regularly delimited file.&lt;/span&gt;
&lt;span class="k"&gt;LOAD&lt;/span&gt; &lt;span class="n"&gt;DATA&lt;/span&gt; &lt;span class="n"&gt;LOCAL&lt;/span&gt; &lt;span class="k"&gt;INFILE&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;/home/shouldsee/Documents/repos/cathdb/cath-domain-list-S35.txt&amp;#39;&lt;/span&gt;
&lt;span class="k"&gt;INTO&lt;/span&gt; &lt;span class="k"&gt;TABLE&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt; 
&lt;span class="n"&gt;FIELDS&lt;/span&gt; &lt;span class="k"&gt;TERMINATED&lt;/span&gt; &lt;span class="k"&gt;by&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;     &amp;#39;&lt;/span&gt; &lt;span class="k"&gt;lines&lt;/span&gt; &lt;span class="k"&gt;terminated&lt;/span&gt; &lt;span class="k"&gt;by&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;\n&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="c1"&gt;#### If however you got fixed-width CATH CLF.&lt;/span&gt;
&lt;span class="k"&gt;LOAD&lt;/span&gt; &lt;span class="n"&gt;DATA&lt;/span&gt; &lt;span class="n"&gt;LOCAL&lt;/span&gt; &lt;span class="k"&gt;INFILE&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;/home/shouldsee/Documents/repos/cathdb/cath-domain-list-S35-v4_1_0.txt&amp;#39;&lt;/span&gt; 
&lt;span class="k"&gt;INTO&lt;/span&gt; &lt;span class="k"&gt;TABLE&lt;/span&gt; &lt;span class="nf"&gt;s35&lt;/span&gt;
&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;@&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="kt"&gt;SET&lt;/span&gt; &lt;span class="n"&gt;domain_id&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nf"&gt;TRIM&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nf"&gt;SUBSTR&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;@&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt;
    &lt;span class="n"&gt;Class&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nf"&gt;TRIM&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nf"&gt;SUBSTR&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;@&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt;
    &lt;span class="n"&gt;arch&lt;/span&gt;  &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nf"&gt;TRIM&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nf"&gt;SUBSTR&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;@&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;14&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;19&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt;
    &lt;span class="n"&gt;topo&lt;/span&gt;  &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nf"&gt;TRIM&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nf"&gt;SUBSTR&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;@&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt;
    &lt;span class="n"&gt;homsf&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nf"&gt;TRIM&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nf"&gt;SUBSTR&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;@&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;26&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;31&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt;
    &lt;span class="n"&gt;s35&lt;/span&gt;   &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nf"&gt;TRIM&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nf"&gt;SUBSTR&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;@&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;32&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;37&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt;
    &lt;span class="n"&gt;s60&lt;/span&gt;   &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nf"&gt;TRIM&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nf"&gt;SUBSTR&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;@&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;38&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;43&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt;
    &lt;span class="n"&gt;s95&lt;/span&gt;   &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nf"&gt;TRIM&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nf"&gt;SUBSTR&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;@&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;44&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;49&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt;
    &lt;span class="n"&gt;s100&lt;/span&gt;  &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nf"&gt;TRIM&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nf"&gt;SUBSTR&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;@&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;55&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt;
    &lt;span class="n"&gt;s100_seqcnt&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nf"&gt;TRIM&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nf"&gt;SUBSTR&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;@&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;56&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;61&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt;
    &lt;span class="n"&gt;domain_length&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nf"&gt;TRIM&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nf"&gt;SUBSTR&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;@&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;62&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;67&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt;
    &lt;span class="n"&gt;resolution&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nf"&gt;TRIM&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nf"&gt;SUBSTR&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;@&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;68&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;73&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;

&lt;span class="k"&gt;SELECT&lt;/span&gt; &lt;span class="n"&gt;domain_id&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;arch&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;topo&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;s35&lt;/span&gt; &lt;span class="k"&gt;from&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt; &lt;span class="k"&gt;limit&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;mysql&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="k"&gt;select&lt;/span&gt; &lt;span class="n"&gt;domain_id&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;arch&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;topo&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;s35&lt;/span&gt; &lt;span class="k"&gt;from&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt; &lt;span class="k"&gt;limit&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; 
&lt;span class="o"&gt;+----------+-------+------+------+-------+------+&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;domain_id&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;Class&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;arch&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;topo&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;  &lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="o"&gt;+----------+-------+------+------+-------+------+&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="n"&gt;oaiA00&lt;/span&gt;  &lt;span class="o"&gt;|&lt;/span&gt;     &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;   &lt;span class="mi"&gt;10&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="mi"&gt;10&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="n"&gt;frhA01&lt;/span&gt;  &lt;span class="o"&gt;|&lt;/span&gt;     &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;   &lt;span class="mi"&gt;10&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="mi"&gt;10&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="n"&gt;oksA00&lt;/span&gt;  &lt;span class="o"&gt;|&lt;/span&gt;     &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;   &lt;span class="mi"&gt;10&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="mi"&gt;10&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="mi"&gt;3&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="n"&gt;un2B00&lt;/span&gt;  &lt;span class="o"&gt;|&lt;/span&gt;     &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;   &lt;span class="mi"&gt;10&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="mi"&gt;10&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="n"&gt;cukA03&lt;/span&gt;  &lt;span class="o"&gt;|&lt;/span&gt;     &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;   &lt;span class="mi"&gt;10&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="mi"&gt;10&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="mi"&gt;5&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="o"&gt;+----------+-------+------+------+-------+------+&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;ul&gt;
&lt;li&gt;Note that raw &lt;a href="http://download.cathdb.info/cath/releases/latest-release/cath-classification-data/README-cath-list-file-format.txt"&gt;CATH CLF files&lt;/a&gt; are fixed-width.&lt;/li&gt;
&lt;li&gt;In case you are not familiar with the organisation of CATH, each "Class" node branches into "Architecture(arch)" children nodes, which in turn branches into "Topology(topo)" children nodes, so on and so forth. &lt;a href="http://wiki.cathdb.info/wiki-beta/doku.php?id=faq"&gt;CATH FAQ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Original "cath-domain-list-S35.txt" can be downloaded from &lt;a href="http://download.cathdb.info/cath/releases/all-releases/v4_1_0/cath-classification-data/cath-domain-list-S35-v4_1_0.txt"&gt;CATH&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Now we have a MySQL table containing all S35 representative structures (S35rep), which allows me to filter the table with some criteria. such as:
1. "&lt;code&gt;SELECT * FROM s35 WHERE Class=1;&lt;/code&gt;" : This will give you all Class 1 S35rep's (You should get 4645 rows).
2. "&lt;code&gt;SELECT * FROM s35 WHERE resolution&amp;lt;1.0;&lt;/code&gt;" : This should give all s35rep with a structual resolution &amp;lt; 1.0 (183 rows)&lt;/p&gt;
&lt;h4&gt;2. Create relations between entries.&lt;/h4&gt;
&lt;p&gt;But there is something I can not fulfill using this structure: Some homologous family (homsf) will have a large number of s35rep (&amp;gt;100) whereas most homsf's will only have several (&amp;lt;5). So it is desirable to filter out the big homsf's only. For example, to count the s35rep in 1.10.8.10, just issue &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;SELECT COUNT(*) FROM s35 WHERE (Class,arch,topo,homsf)=(1,10,8,10);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;And it should return a table saying you got 53 entries, which should all be s35rep's. The problem is: &lt;strong&gt;where should we store this number?&lt;/strong&gt; We can certainly add a "s35_seqcnt" column into the "s35" table and set all s35rep in (1,10,8,10) to have a "s35_seqcnt" of 53, but careful readers must feel dangerous with this approach, reasons are:
1. All entries in "s35" table represent s35rep nodes. From this perspective, any s35rep should only have a s35_count of 1, which refers to itself. 
2. Every time this number changes, (say one s35rep is removed), we will need to update all ~50 entries with the new value (say 52).&lt;/p&gt;
&lt;p&gt;Think about it, s35seq_cnt is a property of homsf, not s35rep itself. If we had a homsf node representing (1,10,8,10), we could have easily set its s35seq_cnt field to be 53, solving both problems at once. Luckily, MySQL is also known as relational database, which means it is built to store relationship. In other words, we can store not only values (e.g: integers,floats,strings), but also cursors to other entries. For this hypothetical homsf node (1,10,8,10), we can actually store a list of cursors pointing to all 53 s35rep's contained within it. &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;DROP&lt;/span&gt; &lt;span class="k"&gt;TABLE&lt;/span&gt; &lt;span class="k"&gt;IF&lt;/span&gt; &lt;span class="k"&gt;EXISTS&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;CREATE&lt;/span&gt; &lt;span class="k"&gt;TABLE&lt;/span&gt; &lt;span class="nf"&gt;homsf&lt;/span&gt;
  &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt; &lt;span class="kt"&gt;INT&lt;/span&gt; &lt;span class="kp"&gt;AUTO_INCREMENT&lt;/span&gt; &lt;span class="k"&gt;PRIMARY&lt;/span&gt; &lt;span class="k"&gt;KEY&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="c1"&gt;### Set an index for cursor in the future&lt;/span&gt;
  &lt;span class="n"&gt;s35_count&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="c1"&gt;## This is new!&lt;/span&gt;
  &lt;span class="n"&gt;Class&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="n"&gt;arch&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="n"&gt;topo&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="n"&gt;homsf&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="c1"&gt;### For homsf, we don&amp;#39;t need index from s35 onwards, but we keep these fields to allow for easier manipulation.&lt;/span&gt;
  &lt;span class="n"&gt;s35&lt;/span&gt;  &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="k"&gt;DEFAULT&lt;/span&gt; &lt;span class="no"&gt;NULL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="n"&gt;s60&lt;/span&gt;  &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="k"&gt;DEFAULT&lt;/span&gt; &lt;span class="no"&gt;NULL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="n"&gt;s95&lt;/span&gt;  &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="k"&gt;DEFAULT&lt;/span&gt; &lt;span class="no"&gt;NULL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="n"&gt;s100&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="k"&gt;DEFAULT&lt;/span&gt; &lt;span class="no"&gt;NULL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="n"&gt;domain_length&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="k"&gt;DEFAULT&lt;/span&gt; &lt;span class="no"&gt;NULL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="n"&gt;resolution&lt;/span&gt; &lt;span class="kt"&gt;float&lt;/span&gt; &lt;span class="k"&gt;DEFAULT&lt;/span&gt; &lt;span class="no"&gt;NULL&lt;/span&gt;
  &lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="c1"&gt;### Insert distinct entries into homsf.&lt;/span&gt;
&lt;span class="c1"&gt;### Since we set &amp;quot;id&amp;quot; to be AUTO_INCREMENT, we don&amp;#39;t need to assign it since it will be auto-generated&lt;/span&gt;
&lt;span class="k"&gt;INSERT&lt;/span&gt; &lt;span class="k"&gt;INTO&lt;/span&gt; &lt;span class="nf"&gt;homsf&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;arch&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;topo&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
   &lt;span class="k"&gt;SELECT&lt;/span&gt; &lt;span class="k"&gt;DISTINCT&lt;/span&gt; &lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;arch&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;topo&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;homsf&lt;/span&gt; &lt;span class="k"&gt;FROM&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Now we would have a table containing all 2737 homsf's, but we have yet to establish the relation between 'homsf' and 's35'. We will use the "id" column of homsf since it is the indexed primary key, which allows for fast lookup. We will:
1. Create a "homsf_id" column in s35 to store its parental homsf node's id.
2. Fill this "homsf_id" using a for loop.
3. Add a foreign key constraint to this column. &lt;/p&gt;
&lt;p&gt;In fact, step 1,2 would suffice to specify the relation. Doing step 3 is only for maintainence purpose and constrain any future modification towards the tables, which is essentially a built-in test that every furture version of database has to pass. Though at beginning constraints is very annoying and throws many errors like:
1. ERROR 1215 (HY000): Cannot add foreign key constraint  (Oh gosh I want to add a constraint!!! Please let me do it!!! Plz!!!)
2. Error Code: 1452. Cannot add or update a child row: a foreign key constraint fails (Oh you evil constraint! Let go of my table!!! I need to modify it!!! I need to drop it!!! Now!!! Here!!!)
3. ...&lt;/p&gt;
&lt;h4&gt;3. How to deal with errors, and fix your relationship:&lt;/h4&gt;
&lt;p&gt;Errors can be very, very annoying and could ruin hours and hours. However, once you understand how it works, these errors suddenly become useful indications that alert you of the potential hazard within commands you've just thrown upon MySQL. This is strictly speaking not a TDD example, since the test is not written for development but merely for maintaining the integrity of the database. Nevertheless, to understand the conept of "Test" on its own is essential to move on to the idea of TDD.&lt;/p&gt;
&lt;p&gt;Now let's implement the stated operations in MySQL.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;### We split these ADD COLUMN commands since they might throw error if homsf_id already exists, but it would require custom procedure to avert so is not included here.&lt;/span&gt;
&lt;span class="k"&gt;ALTER&lt;/span&gt; &lt;span class="k"&gt;TABLE&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt; 
   &lt;span class="k"&gt;ADD&lt;/span&gt; &lt;span class="k"&gt;COLUMN&lt;/span&gt; &lt;span class="n"&gt;homsf_id&lt;/span&gt; &lt;span class="kt"&gt;INT&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;


&lt;span class="c1"&gt;### Fill s35.homsf_id with correct cursors to homsf.id&lt;/span&gt;
&lt;span class="c1"&gt;### This should only be executed if every s35 can find a homsf. One way to ensure this condition is to create a fresh homsf table from s35. Other approaches with INSERT should be possible.&lt;/span&gt;

&lt;span class="k"&gt;UPDATE&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;
  &lt;span class="k"&gt;LEFT&lt;/span&gt; &lt;span class="k"&gt;JOIN&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt; 
  &lt;span class="k"&gt;ON&lt;/span&gt;  &lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;arch&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;topo&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;arch&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;topo&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="kt"&gt;SET&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;homsf_id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="c1"&gt;### Impose the foreign key constraint.&lt;/span&gt;
&lt;span class="k"&gt;ALTER&lt;/span&gt; &lt;span class="k"&gt;TABLE&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;
   &lt;span class="k"&gt;ADD&lt;/span&gt; &lt;span class="k"&gt;CONSTRAINT&lt;/span&gt; &lt;span class="n"&gt;homsf_fk&lt;/span&gt;
   &lt;span class="k"&gt;FOREIGN&lt;/span&gt; &lt;span class="k"&gt;KEY&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;homsf_id&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
   &lt;span class="k"&gt;REFERENCES&lt;/span&gt; &lt;span class="nf"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; 

&lt;span class="k"&gt;SELECT&lt;/span&gt; &lt;span class="nf"&gt;COUNT&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;FROM&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="c1"&gt;### Confirm homsf does not change size&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;It is useful to simulate a 1452 error to illustrate how to debug a foreign key.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;### Temporarily remove the foreign key.&lt;/span&gt;
&lt;span class="k"&gt;ALTER&lt;/span&gt; &lt;span class="k"&gt;TABLE&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;
   &lt;span class="k"&gt;DROP&lt;/span&gt; &lt;span class="k"&gt;FOREIGN&lt;/span&gt; &lt;span class="k"&gt;KEY&lt;/span&gt; &lt;span class="n"&gt;homsf_fk&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="c1"&gt;### Artificially damage the table&lt;/span&gt;
&lt;span class="k"&gt;DELETE&lt;/span&gt; &lt;span class="k"&gt;FROM&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt;
  &lt;span class="k"&gt;WHERE&lt;/span&gt; &lt;span class="n"&gt;id&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="c1"&gt;###&lt;/span&gt;
&lt;span class="k"&gt;UPDATE&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;
  &lt;span class="kt"&gt;SET&lt;/span&gt; &lt;span class="n"&gt;homsf_id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1234&lt;/span&gt;
  &lt;span class="k"&gt;WHERE&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;homsf_id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="c1"&gt;### NEVER do this to a productive database!!&lt;/span&gt;
&lt;span class="k"&gt;UPDATE&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;
  &lt;span class="kt"&gt;SET&lt;/span&gt; &lt;span class="n"&gt;homsf_id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1234567&lt;/span&gt;
  &lt;span class="k"&gt;WHERE&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;homsf_id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="c1"&gt;### Attempt to impose the foreign key constraint.&lt;/span&gt;
&lt;span class="k"&gt;ALTER&lt;/span&gt; &lt;span class="k"&gt;TABLE&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;
   &lt;span class="k"&gt;ADD&lt;/span&gt; &lt;span class="k"&gt;CONSTRAINT&lt;/span&gt; &lt;span class="n"&gt;homsf_fk&lt;/span&gt;
   &lt;span class="k"&gt;FOREIGN&lt;/span&gt; &lt;span class="k"&gt;KEY&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;homsf_id&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
   &lt;span class="k"&gt;REFERENCES&lt;/span&gt; &lt;span class="nf"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Commands above should throw a 1452:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;ERROR&lt;/span&gt; &lt;span class="mi"&gt;1452&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;23000&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt; &lt;span class="n"&gt;Cannot&lt;/span&gt; &lt;span class="k"&gt;add&lt;/span&gt; &lt;span class="k"&gt;or&lt;/span&gt; &lt;span class="k"&gt;update&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;child&lt;/span&gt; &lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="k"&gt;foreign&lt;/span&gt; &lt;span class="k"&gt;key&lt;/span&gt; &lt;span class="k"&gt;constraint&lt;/span&gt; &lt;span class="nf"&gt;fails&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="ss"&gt;`TEST`&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="ss"&gt;`#sql-78c0_66a`&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;CONSTRAINT&lt;/span&gt; &lt;span class="ss"&gt;`homsf_fk`&lt;/span&gt; &lt;span class="k"&gt;FOREIGN&lt;/span&gt; &lt;span class="k"&gt;KEY&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="ss"&gt;`homsf_id`&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;REFERENCES&lt;/span&gt; &lt;span class="ss"&gt;`homsf`&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="ss"&gt;`id`&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We can find out which key is missing with SELECT ... WHERE ...NOT IN. But note this will NOT report that homsf_id=2 has been redirected to homsf_id=1234 !!&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;SELECT&lt;/span&gt; &lt;span class="k"&gt;DISTINCT&lt;/span&gt; &lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;arch&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;topo&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;homsf_id&lt;/span&gt; &lt;span class="k"&gt;FROM&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;
   &lt;span class="k"&gt;WHERE&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;homsf_id&lt;/span&gt; &lt;span class="k"&gt;NOT&lt;/span&gt; &lt;span class="k"&gt;IN&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;SELECT&lt;/span&gt; &lt;span class="n"&gt;id&lt;/span&gt; &lt;span class="k"&gt;FROM&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="k"&gt;UPDATE&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;
  &lt;span class="k"&gt;LEFT&lt;/span&gt; &lt;span class="k"&gt;JOIN&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt; 
  &lt;span class="k"&gt;ON&lt;/span&gt;  &lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;arch&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;topo&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;arch&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;topo&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;+-------+------+------+-------+----------+&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;Class&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;arch&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;topo&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;homsf_id&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="o"&gt;+-------+------+------+-------+----------+&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt;     &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;   &lt;span class="mi"&gt;10&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="mi"&gt;10&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;        &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt;     &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;   &lt;span class="mi"&gt;10&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="mi"&gt;40&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;  &lt;span class="mi"&gt;1234567&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="o"&gt;+-------+------+------+-------+----------+&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;By inspection, we found homsf_id 1 and 1234567 is not referring to any existing homsf.id, perventing us from installing a constraint. So we might consider create new homsf to accommodate these s35 entries. But wait a minute, we don't want to create new homsf that coincide with an existing homsf! We can ensure this by trying to update homsf_id according to existing homsf table.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;#### Save the sub-table with failed keys to a temp table.&lt;/span&gt;
&lt;span class="k"&gt;DROP&lt;/span&gt; &lt;span class="k"&gt;TABLE&lt;/span&gt; &lt;span class="k"&gt;IF&lt;/span&gt; &lt;span class="k"&gt;EXISTS&lt;/span&gt; &lt;span class="n"&gt;temp&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;CREATE&lt;/span&gt; &lt;span class="k"&gt;TABLE&lt;/span&gt; &lt;span class="n"&gt;temp&lt;/span&gt;
&lt;span class="k"&gt;SELECT&lt;/span&gt; &lt;span class="k"&gt;DISTINCT&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="k"&gt;FROM&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;
   &lt;span class="k"&gt;WHERE&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;homsf_id&lt;/span&gt; &lt;span class="k"&gt;NOT&lt;/span&gt; &lt;span class="k"&gt;IN&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;SELECT&lt;/span&gt; &lt;span class="n"&gt;id&lt;/span&gt; &lt;span class="k"&gt;FROM&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="c1"&gt;#### Dump the proposed fix into a table `temp_fix`&lt;/span&gt;
&lt;span class="k"&gt;DROP&lt;/span&gt; &lt;span class="k"&gt;TABLE&lt;/span&gt; &lt;span class="k"&gt;IF&lt;/span&gt; &lt;span class="k"&gt;EXISTS&lt;/span&gt; &lt;span class="n"&gt;temp_fix&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;CREATE&lt;/span&gt; &lt;span class="k"&gt;TABLE&lt;/span&gt; &lt;span class="n"&gt;temp_fix&lt;/span&gt;
&lt;span class="k"&gt;SELECT&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="n"&gt;homsf_id&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;fixed_homsf_id&lt;/span&gt; &lt;span class="k"&gt;FROM&lt;/span&gt; &lt;span class="n"&gt;temp&lt;/span&gt; &lt;span class="k"&gt;AS&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;
  &lt;span class="k"&gt;LEFT&lt;/span&gt; &lt;span class="k"&gt;JOIN&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt; 
  &lt;span class="k"&gt;ON&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;arch&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;topo&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;arch&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;topo&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="c1"&gt;####&lt;/span&gt;
&lt;span class="k"&gt;SELECT&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="k"&gt;FROM&lt;/span&gt; &lt;span class="n"&gt;temp_fix&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We can see that MySQL proposed a valid change for 58th s35 but NULL for the rest. We can apply the proposed update, and reinstall the foreign key constraint.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;UPDATE&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt; 
  &lt;span class="k"&gt;JOIN&lt;/span&gt; &lt;span class="n"&gt;temp_fix&lt;/span&gt; &lt;span class="k"&gt;ON&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;temp_fix&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;
  &lt;span class="kt"&gt;SET&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;homsf_id&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;temp_fix&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fixed_homsf_id&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;ALTER&lt;/span&gt; &lt;span class="k"&gt;TABLE&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt;
   &lt;span class="k"&gt;ADD&lt;/span&gt; &lt;span class="k"&gt;CONSTRAINT&lt;/span&gt; &lt;span class="n"&gt;homsf_fk&lt;/span&gt;
   &lt;span class="k"&gt;FOREIGN&lt;/span&gt; &lt;span class="k"&gt;KEY&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;homsf_id&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
   &lt;span class="k"&gt;REFERENCES&lt;/span&gt; &lt;span class="nf"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;  
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;At first glance, one would expect foreign key to fail agian, because we know some homsf_id was updated to NULL, which is not withinse homsf.id. However, a NULL does not constitue a violation to foregin key constraint. To illustrate in more detail:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;SELECT&lt;/span&gt; &lt;span class="nf"&gt;COUNT&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;FROM&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt; &lt;span class="k"&gt;WHERE&lt;/span&gt; &lt;span class="n"&gt;homsf_id&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt; &lt;span class="no"&gt;NULL&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="c1"&gt;## returns 53&lt;/span&gt;
&lt;span class="k"&gt;SELECT&lt;/span&gt; &lt;span class="nf"&gt;COUNT&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;FROM&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt; 
  &lt;span class="k"&gt;WHERE&lt;/span&gt; &lt;span class="n"&gt;homsf_id&lt;/span&gt; &lt;span class="k"&gt;IS&lt;/span&gt; &lt;span class="no"&gt;NULL&lt;/span&gt; 
  &lt;span class="k"&gt;AND&lt;/span&gt; &lt;span class="n"&gt;homsf_id&lt;/span&gt; &lt;span class="k"&gt;IN&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;SELECT&lt;/span&gt; &lt;span class="n"&gt;id&lt;/span&gt; &lt;span class="k"&gt;FROM&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="c1"&gt;## Returns 0&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We see that homsf_id=NULL is indeed not considered within the homsf.id. We conclude foreign key constraint allows exception only if the expcetion is NULL.&lt;/p&gt;
&lt;p&gt;Recall that we redirected homsf_id=2 to homsf_id=1234 when destroying the database. Note this was not fixed during the procedure above. We can compare entries from s35 and from homsf&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;SELECT&lt;/span&gt; &lt;span class="k"&gt;DISTINCT&lt;/span&gt; &lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;arch&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;topo&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;homsf_id&lt;/span&gt;
   &lt;span class="k"&gt;FROM&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt; &lt;span class="k"&gt;WHERE&lt;/span&gt; &lt;span class="n"&gt;homsf_id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1234&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;SELECT&lt;/span&gt; &lt;span class="k"&gt;DISTINCT&lt;/span&gt; &lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;arch&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;topo&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt; &lt;span class="k"&gt;AS&lt;/span&gt; &lt;span class="n"&gt;homsf_id&lt;/span&gt;
   &lt;span class="k"&gt;FROM&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt; &lt;span class="k"&gt;WHERE&lt;/span&gt; &lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1234&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Result:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;mysql&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="k"&gt;SELECT&lt;/span&gt; &lt;span class="k"&gt;DISTINCT&lt;/span&gt; &lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;arch&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;topo&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;homsf_id&lt;/span&gt;
    &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;    &lt;span class="k"&gt;FROM&lt;/span&gt; &lt;span class="n"&gt;s35&lt;/span&gt; &lt;span class="k"&gt;WHERE&lt;/span&gt; &lt;span class="n"&gt;homsf_id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1234&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="o"&gt;+-------+------+------+-------+------+----------+&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;Class&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;arch&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;topo&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;id&lt;/span&gt;   &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;homsf_id&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="o"&gt;+-------+------+------+-------+------+----------+&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt;     &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;   &lt;span class="mi"&gt;10&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="mi"&gt;20&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;   &lt;span class="mi"&gt;54&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;     &lt;span class="mi"&gt;1234&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt;     &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;   &lt;span class="mi"&gt;10&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="mi"&gt;20&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;   &lt;span class="mi"&gt;55&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;     &lt;span class="mi"&gt;1234&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt;     &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;   &lt;span class="mi"&gt;10&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="mi"&gt;20&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;   &lt;span class="mi"&gt;56&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;     &lt;span class="mi"&gt;1234&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt;     &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;   &lt;span class="mi"&gt;10&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="mi"&gt;20&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;   &lt;span class="mi"&gt;57&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;     &lt;span class="mi"&gt;1234&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt;     &lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;   &lt;span class="mi"&gt;60&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;   &lt;span class="mi"&gt;40&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;  &lt;span class="mi"&gt;1330&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="mi"&gt;7906&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;     &lt;span class="mi"&gt;1234&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="o"&gt;+-------+------+------+-------+------+----------+&lt;/span&gt;
&lt;span class="mi"&gt;5&lt;/span&gt; &lt;span class="n"&gt;rows&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="kt"&gt;set&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;00&lt;/span&gt; &lt;span class="n"&gt;sec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;mysql&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="k"&gt;SELECT&lt;/span&gt; &lt;span class="k"&gt;DISTINCT&lt;/span&gt; &lt;span class="n"&gt;Class&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;arch&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;topo&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt; &lt;span class="k"&gt;AS&lt;/span&gt; &lt;span class="n"&gt;homsf_id&lt;/span&gt;
    &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;    &lt;span class="k"&gt;FROM&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt; &lt;span class="k"&gt;WHERE&lt;/span&gt; &lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1234&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="o"&gt;+-------+------+------+-------+----------+&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;Class&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;arch&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;topo&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;homsf&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;homsf_id&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="o"&gt;+-------+------+------+-------+----------+&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt;     &lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;   &lt;span class="mi"&gt;60&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;   &lt;span class="mi"&gt;40&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;  &lt;span class="mi"&gt;1330&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;     &lt;span class="mi"&gt;1234&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="o"&gt;+-------+------+------+-------+----------+&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="kt"&gt;set&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;01&lt;/span&gt; &lt;span class="n"&gt;sec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Some homsf_id is clearly pointing to the wrong homsf entry, without breaking the foregin key constraint, which render the foregin key meaningless. Think about it, if we want to access the homsf_index of a given s35 (id=54), should we:
    1. query the s35 table at (Class,arch,topo,homsf) or
    2. query the homsf entry as specified homsf_id '1234' ?  &lt;/p&gt;
&lt;p&gt;With the first approach , query returns 1.10.8.20, whereas with the second approach, query returns 2.60.40.1330. How should we resolve such conflict? Obviously, if we were to enjoy the privlege of foreign key, we should keep the result from second approach. Why? Because we don't even need foreign key in the first approach! &lt;/p&gt;
&lt;p&gt;In reality, however, one would prefer to avoid generating such conflict in the first place, which can be achieved by dropping the (Class, arch, topo, homsf) columns from s35 table, effectively rendering first approach inviable and forcing the second approach. We will not expand the full implementation here and please feel free to practice it.&lt;/p&gt;
&lt;h4&gt;Sidenotes:&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;NULL or NOT NULL, this is a question:&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;​Recall we updated some homsf_id to NULL in s35 when attempting the fix. This is only possible if the homsf_id column is nullable. We can check the column property by calling
  &lt;code&gt;sql
  SHOW COLUMNS FROM s35;&lt;/code&gt;
  And check the "Null" column of the output.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;DROP TABLE IF NOT EXISTS: 
  This command may not work on some version of SQL. It is quite handy to append "if not exists" to avoid error, but unfortunately it is not available for commands like ADD COLUMN, DROP COLUMN.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Cross database FOREIGN KEY error:&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;When attempting to drop a database that is referred by other database, one would raise ERROR 1217 (23000) at line xxx: Cannot delete or update a parent row: a foreign key constraint fails. Two options availabe:
  1. Inspect the violated foreign key and attempt manual fix by checking "LATEST FOREIGN KEY ERROR" from the output of :
  &lt;code&gt;mysql
  SHOW ENGINE INNODB STATUS;&lt;/code&gt;
  2. Disable foreign key constraint and force a drop (only if you are confident this won't break anything.)&lt;/p&gt;
&lt;p&gt;&lt;code&gt;mysql
  SET foreign_key_checks = 0;
  DROP DATABASE ...
  SET foreign_key_checks = 1;&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;CUSTOM PROCEDURE: 
  Custom functions in SQL is called procedures, but beginners like me should avoid writing custom functions whenever possible, because they are very difficult to write correctly!&lt;/li&gt;
&lt;li&gt;Version Control:
  To make sure results are reproducible, one should always write purposeful codes stored in files, preferably ending with ".sql". To avoid having to write SQL procedures, one may consider defining bash function that execute a designated ".sql" file instead and writing corresponding tests in bash. Another workaround is to store SQL code in Django migration files and execute using &lt;a href="https://docs.djangoproject.com/en/1.11/ref/migration-operations/#runsql"&gt;django.db.migrations.RunSQL()&lt;/a&gt;. By keeping a track of data source flatfiles,".sql" files and ".py" migration files and even ".json" &lt;a href="https://coderwall.com/p/mvsoyg/django-dumpdata-and-loaddata"&gt;fixtures&lt;/a&gt;, we can restore to any state we want.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Feng Geng&lt;br&gt;
Summer Student&lt;br&gt;
ISMB,UCL&lt;/p&gt;
&lt;p&gt;at line xxx: Cannot delete or update a parent row: a foreign key constraint fails. Two options availabe:
  1. Inspect the violated foreign key and attempt manual fix by checking "LATEST FOREIGN KEY ERROR" from the output of :
  &lt;code&gt;mysql
  SHOW ENGINE INNODB STATUS;&lt;/code&gt;
  2. Disable foreign key constraint and force a drop (only if you are confident this won't break anything.)&lt;/p&gt;
&lt;p&gt;&lt;code&gt;mysql
  SET foreign_key_checks = 0;
  DROP DATABASE ...
  SET foreign_key_checks = 1;&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;CUSTOM PROCEDURE: 
  Custom functions in SQL is called procedures, but beginners like me should avoid writing custom functions whenever possible, because they are very difficult to write correctly!&lt;/li&gt;
&lt;li&gt;Version Control:
  To make sure results are reproducible, one should always write purposeful codes stored in files, preferably ending with ".sql". To avoid having to write SQL procedures, one may consider defining bash function that execute a designated ".sql" file instead and writing corresponding tests in bash. Another workaround is to store SQL code in Django migration files and execute using &lt;a href="https://docs.djangoproject.com/en/1.11/ref/migration-operations/#runsql"&gt;django.db.migrations.RunSQL()&lt;/a&gt;. By keeping a track of data source flatfiles,".sql" files and ".py" migration files and even ".json" &lt;a href="https://coderwall.com/p/mvsoyg/django-dumpdata-and-loaddata"&gt;fixtures&lt;/a&gt;, we can restore to any state we want.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Feng Geng&lt;br&gt;
Summer Student&lt;br&gt;
ISMB,UCL&lt;/p&gt;</content><category term="program"></category><category term="program"></category><category term="english"></category></entry><entry><title>风城纪事·暗黑</title><link href="http://www.newflaw.com/blog/articles/story/feng-cheng-ji-shi-an-hei/" rel="alternate"></link><published>2017-07-05T06:59:00+01:00</published><updated>2017-07-05T06:59:00+01:00</updated><author><name>F. Geng</name></author><id>tag:www.newflaw.com,2017-07-05:/blog/articles/story/feng-cheng-ji-shi-an-hei/</id><summary type="html">&lt;p&gt;（全文虚构，名词与现实并不完全对应）&lt;/p&gt;
&lt;p&gt;我和母亲在法国旅游，有两个火车站，它们互相之间遥相互应，但是又有一条复古的轨道连接其中，大约是为了运输换乘的旅客。我们旅游到此地，寻思着要不要去另一个火车站赶去下一个景点的火车。&lt;/p&gt;
&lt;p&gt;“呜～～～～～”，换乘列车拖着长长的气笛声开动了。心中传来了阵阵失落————这班车恐怕是赶不上了！我和母亲商量：另一个车站看起来并不是很远，我们应该可以步行过去。奇怪的是，换乘列车好像和行人共用一个隧道,&lt;/p&gt;
&lt;p&gt;&lt;img src="http://newflaw.com/blog/wp-content/uploads/2017/07/IMG_1387-300x298.jpg" alt="" width="100%" height="298" class="alignnone size-medium wp-image-955" /&gt;&lt;/p&gt;
&lt;p&gt;隧道上面有个信号灯，为了不撞上火车，我们选择在信号灯熄灭的时候进入隧道，没曾想，刚进隧道就遇上了迎面而来的火车，我们赶紧向左拐入了旅店，才没有被撞上 …&lt;/p&gt;</summary><content type="html">&lt;p&gt;（全文虚构，名词与现实并不完全对应）&lt;/p&gt;
&lt;p&gt;我和母亲在法国旅游，有两个火车站，它们互相之间遥相互应，但是又有一条复古的轨道连接其中，大约是为了运输换乘的旅客。我们旅游到此地，寻思着要不要去另一个火车站赶去下一个景点的火车。&lt;/p&gt;
&lt;p&gt;“呜～～～～～”，换乘列车拖着长长的气笛声开动了。心中传来了阵阵失落————这班车恐怕是赶不上了！我和母亲商量：另一个车站看起来并不是很远，我们应该可以步行过去。奇怪的是，换乘列车好像和行人共用一个隧道,&lt;/p&gt;
&lt;p&gt;&lt;img src="http://newflaw.com/blog/wp-content/uploads/2017/07/IMG_1387-300x298.jpg" alt="" width="100%" height="298" class="alignnone size-medium wp-image-955" /&gt;&lt;/p&gt;
&lt;p&gt;隧道上面有个信号灯，为了不撞上火车，我们选择在信号灯熄灭的时候进入隧道，没曾想，刚进隧道就遇上了迎面而来的火车，我们赶紧向左拐入了旅店，才没有被撞上。&lt;/p&gt;
&lt;p&gt;迎面碰上了旅店的前台老板（娘），他走来的时候嘴里居然正念叨着上海话，我怒不可遏地质询他：“农个的哪能搞伐啦子额啦？一啦胡粗开股来弄灯哪能哈额嘛？脏到宁哪能办法子？搞撒子搞啦？……”（译：你这里搞得什么鬼东西啊？它火车开过来你这灯怎么也是黑的啦？撞到人怎么办啊？搞什么搞啊？……）&lt;/p&gt;
&lt;p&gt;预想中的赔礼道歉全然没有出现，老板居然理直气壮地骂道：“侬伐要过则子噶慧德港桑还艾唔就哪能噶了，无帮侬刚个的思法股！弄刚桑还艾唔没宁听呃懂额！哦！伐要哈刚巴刚哦！”（译：你不要觉得自己会讲上海话就怎么样了！我告诉你哦这里是法国！你讲上海话可是没人听得懂的！哦！不要瞎讲八讲哦！）&lt;/p&gt;
&lt;p&gt;这一瘪真是吃的实实在在，被无语和愤怒裹携着，我进入了旅馆的一个房间，一个面若冰霜/死灰的姑娘正望着墙上的画出神，好像是她自己的作品。不知什么原因，我们讨论起了”法国的上海人“这个话题。&lt;/p&gt;
&lt;p&gt;她说，你们上海人都是被卖的命，在这里都会被作为“可爱.魅惑红”卖出去————没有希望的，这个社会就是这样的黑暗，你们上海人就是这样被卖成奴隶的命……我跟她争辩，我们还可以是“可爱.理性蓝”，“可爱.深沉黑”，我们上海人，不止是被卖的命啊！&lt;/p&gt;
&lt;p&gt;姑娘无动于衷，喃喃道，”是黑暗的，是黑暗的……我只能被卖为奴，没有别的路的……“。我听不下去了，告诉她无论什么在哪里调用都一定要加上”--冷淡 --偶尔的热情“这两个参数。之后，我和母亲便离开了房间。大约是第二天，姑娘在我们前往的那个火车站拦下了我，眼里好像有了光彩，叫我再去那个房间里。&lt;/p&gt;
&lt;p&gt;可是一进入房间，她又回到了开始的那个状态，无所谓地呢喃着……我的情绪快要爆炸，大声向她吼：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;The only darkness, is the darkness in yourself!&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;（译：你心中的黑暗，才是惟一的黑暗！）她稍稍一惊，我却已然离开现场。&lt;/p&gt;
&lt;p&gt;离开那里以后，我琢磨着，自己怎么会吼出这样的句子？我想着，反复念着……然后我就醒了，发现我正戴着降噪耳机，口中念念有词。&lt;/p&gt;
&lt;p&gt;一七年七月五日晨&lt;/br&gt;
伦敦&lt;/p&gt;</content><category term="story"></category><category term="chinese"></category><category term="thoughts"></category><category term="story"></category></entry><entry><title>风城纪事·取代</title><link href="http://www.newflaw.com/blog/articles/thoughts/feng-cheng-ji-shi-qu-dai/" rel="alternate"></link><published>2017-07-02T21:33:00+01:00</published><updated>2017-07-02T21:33:00+01:00</updated><author><name>F. Geng</name></author><id>tag:www.newflaw.com,2017-07-02:/blog/articles/thoughts/feng-cheng-ji-shi-qu-dai/</id><summary type="html">&lt;p&gt;多少次我们以为自己的世界是唯一的，多少次我们领悟到他人的世界却可以和我们的一样丰满。可是这些之于我们又有多大的意义？&lt;/p&gt;
&lt;p&gt;我们怕不怕自己被取代？猫做老虎的老师时，留了一手没教他上树。这个寓言极形象地刻画了对于被取代的恐惧。“彼可取而代之！”不可取代性，看来是建构身份的一条途径。联想物理中的对易性，在很多的操作下，一个特定元素的某些性质是无关紧要的，但是在另一些操作下，该元素的某些状态会影响操作的结果。例子包括手性等。又比如说取平方这个操作，其结果是不取决于输入的正负号的，也就是说，正号负号可以相互被取代。
&lt;!--more--&gt;&lt;/p&gt;
&lt;p&gt;用系统论的语言讲，不可取代性依赖于从某些输出反向传导来的约束，因为这个输出是依赖于某个特定性质的，所以这个性质是不可取代的。但是 …&lt;/p&gt;</summary><content type="html">&lt;p&gt;多少次我们以为自己的世界是唯一的，多少次我们领悟到他人的世界却可以和我们的一样丰满。可是这些之于我们又有多大的意义？&lt;/p&gt;
&lt;p&gt;我们怕不怕自己被取代？猫做老虎的老师时，留了一手没教他上树。这个寓言极形象地刻画了对于被取代的恐惧。“彼可取而代之！”不可取代性，看来是建构身份的一条途径。联想物理中的对易性，在很多的操作下，一个特定元素的某些性质是无关紧要的，但是在另一些操作下，该元素的某些状态会影响操作的结果。例子包括手性等。又比如说取平方这个操作，其结果是不取决于输入的正负号的，也就是说，正号负号可以相互被取代。
&lt;!--more--&gt;&lt;/p&gt;
&lt;p&gt;用系统论的语言讲，不可取代性依赖于从某些输出反向传导来的约束，因为这个输出是依赖于某个特定性质的，所以这个性质是不可取代的。但是，这里讨论的不可取代性充其量只是一种约束条件，比如说一个数必须比一大比二小。为了更好地理解“取代”，我们设想有不同个体，在竞争一个联系/地位，这个地位对个体的某些性质提出了约束（通过前述的方式）。这个约束不一定是一成不变的，甚至可以任意复杂，也可以是其他元素的一个函数。&lt;/p&gt;
&lt;p&gt;那么，对“被取代”的恐惧，首先要基于对该地位的愿望。在与该地位的交互中，个体可以猜测约束的具体形式，如果他判断其他个体也满足这个约束，那么即可理性推断自己被取代是可行的。为了不被取代，该个体必然寻求改变约束的形式，或者干涉取代的过程本身，暂不加展开。
考虑特殊情况：该个体如若判断其他个体和自己是完全相同的，则无法推算约束的形式，也就无法否定“取代”的可行性，也就很难避免恐惧。&lt;/p&gt;
&lt;p&gt;一七年六月九日
失眠
于伦敦&lt;/p&gt;</content><category term="thoughts"></category><category term="thoughts"></category><category term="chinese"></category></entry><entry><title>轨迹，签证，熵</title><link href="http://www.newflaw.com/blog/articles/thoughts/gui-ji-qian-zheng-shang/" rel="alternate"></link><published>2017-06-30T21:37:00+01:00</published><updated>2017-06-30T21:37:00+01:00</updated><author><name>F. Geng</name></author><id>tag:www.newflaw.com,2017-06-30:/blog/articles/thoughts/gui-ji-qian-zheng-shang/</id><summary type="html">&lt;p&gt;想来我需要写一点成块的文章，光罗列点可不行，这样取出的永远是语义*的（semantic）碎片。&lt;/p&gt;
&lt;p&gt;人的生命大概可以用轨迹（trajectory）来很好地描述，轨迹是经典物理的经典概念，考虑一个决定性的经典粒子，其轨迹可以完全被上一时刻的条件所预测。建模与预测，这是物理学的发源之地（天文学以预测为基石）。（另，量子力学对薛定谔方程的解释方法不能完全满足定域性，决定性，因果性。也就是说，不存在一个定域的，决定性的，因果的理论能介绍薛定谔方程（但是薛定谔方程不可能是“错 …&lt;/p&gt;</summary><content type="html">&lt;p&gt;想来我需要写一点成块的文章，光罗列点可不行，这样取出的永远是语义*的（semantic）碎片。&lt;/p&gt;
&lt;p&gt;人的生命大概可以用轨迹（trajectory）来很好地描述，轨迹是经典物理的经典概念，考虑一个决定性的经典粒子，其轨迹可以完全被上一时刻的条件所预测。建模与预测，这是物理学的发源之地（天文学以预测为基石）。（另，量子力学对薛定谔方程的解释方法不能完全满足定域性，决定性，因果性。也就是说，不存在一个定域的，决定性的，因果的理论能介绍薛定谔方程（但是薛定谔方程不可能是“错”的）。）&lt;/p&gt;
&lt;p&gt;讲讲今天签证的事儿吧，周五晚上本想打印一份学生证明，跑到办公室时却刚好到下班时间，有两位顾客走出门外我却忘记鼓起勇气冲进去麻烦工作人员。当他把门锁上时我知道已经晚了。签证的问题其实还不在这，等我认认真真准备了材料，跑到法签中心排完队，刚开始过第一关，前台就告诉我，由于两次入境国家不一样，且第一入境国不是法国，法签不能受理我的申请。她告诉我两个补救措施：1.去意大利领馆申请 2.把行程改成连续的 被吓懵的我选择了第二条路，跑到网咖里做了个伪（Pseudo）行程，花掉了25EUR+22EUR+(70EUR，可能还可以退)。还好网咖不远，环境也好，老板也有风度，倒让我有一种写论文的冲动（对比法签中心，简直人山人海，纸醉金迷，胆战心惊，人云亦云，气氛实在不对）。&lt;/p&gt;
&lt;p&gt;说到底，申根签的审核就是个笑话，根据木桶原理，最短的那根板是限制因素（limiting process）：最松的申根国家就贡献了最大的流量。申根的怪圈就在于，其他国家越严，签证过程价值就越高，于是木桶的短板就漏过更多的漏网之鱼。边境管制是一句空话，申根牺牲了安全性换取了流动性。但我最想吐槽的是，我想要老老实实申报真实行程，却遭到简简单单一句“不予受理”，最后虚报行程，反而顺风顺水。这使得我严重怀疑申根签证的逻辑——事实上，这种官僚体制会逼迫人们说假话，做假事。我今天突然理解了小时候经常看到的“办证”广告，那是因为在官僚体制的逻辑下，价值可以独立于真相存在——“我不在乎这句话是对是错，我只在乎这句话是谁说的。”&lt;/p&gt;
&lt;p&gt;最近人好像变得越来越犹豫，一方面觉得自信的生活不应该游移，一方面为了最大化回报的期望又苦苦思索最优解。正如神经网络的Explore-Exploit难题，一方面需要最小化消耗函数，一方面又要考虑时间本身的价值，真是难上加难。其实回到轨迹的类比上来，哪会有什么最优解（尽管这回导致我会被学过优化的人们喷死）。隐性地说，人的决策是不可能找到一个最优解的，因为计算最优解的过程常常是一个停机程序/不可计算程序。身处动态的世界里，哪有什么不变的测度（尽管不变性是物理的一个基本直觉）。如果想要走到那条最为宽阔的坦途上（回报率最高），就必然要抛弃大量的计算资源，因而造成时间的流逝，然而时间一旦流逝，坦途的宽度就又得重新计算了，如此往复，好似会走上流数/微积分的思路，但我仍然不认为这个迭代操作会给出一个最优化的解。或者也可以这样说，最优解轨迹往往伴随着熵的降低，从玻尔兹曼热动力学的角度来讲，是极小概率的事件;若想要按照最优解行进，就必然需要耦合一个熵增/放热过程，以符合热力学第二定律的约束。所以反过来推，就像测不准定律一样，人对自己的轨迹只能施加有限的约束，而不能保证绝对的服从，这和熵增定律是类似的。&lt;/p&gt;
&lt;p&gt;当然也会有一些奇妙的情况，也就是不能用热力学第二定律理解的情况——复杂性的涌现。或者说，尽管在微观上人不可能完全约束自己的轨迹，整个世界的宏观轨迹却反而诡异的紧——约束并没有显得更少，或者说，大系统并不显现出缺乏约束的特质，而是反而显现出能被很好预测的轨迹，也就是说，一群被热二限制住的不能走最优轨迹的粒子，反而组成了一个总是走最优轨迹的系统。这种诡异的涌现特质，使得整个世界根本不可能陷入热寂。当然我们可以强调这个大系统以摄取能量/排出熵的代价降低了自己的熵（普利高津的结论），但这走的是隔离法的路线了（也是热学的经典直觉），但是我更想考虑这个熵的减少是不是耦合在了从微观映射到宏观这个过程本身，也就是说，是不是尺度的变化本身导致了熵的显变化？&lt;/p&gt;
&lt;p&gt;最后让我们讨论一下隐性的（Implicit）含义，譬如我现在要写这篇文章，我会假设一个隐性的语境（比如中文就是一个隐性假设），在许许多多个隐性假设下，我才能够有效地传达一些信息。如果抛弃各个隐性假设，那么文章将变得不可接受的冗长，于是反推可得，隐性假设起到的是压缩信息的作用，这些被压缩的信息于是可以获得更快的传播速度，但同时也不再通用（Universal）。比如说一篇科研论文就会假设读者拥有相当多的储备知识，再比如政治喜剧会假设听众有一定的政治常识，再比如一篇假文凭/假行程会假设采信机构......是个傻逼。显然，假行程不是通用的，但是在官僚体制这个隐性假设下，它很有效地传达了递签者迫切的求签心态和端正的求签态度。“见人说人话，见鬼说鬼话”也是一个道理，采用恰当的隐性假设，就能最大化信息的传输效率。&lt;/p&gt;
&lt;p&gt;12/12/2016
圣瓶&lt;/p&gt;
&lt;p&gt;*： 一些语义性陈述（Semantic Statements）：&lt;/p&gt;
&lt;p&gt;1.医生的无能令病人恼怒。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;回忆（Reflection）令人笑。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;梦是快乐的。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;4.新西兰和机器人是遥远的过去。&lt;/p&gt;
&lt;p&gt;5.过去是美的。&lt;/p&gt;
&lt;p&gt;6.现在是混乱的。&lt;/p&gt;
&lt;p&gt;7.回头是不可能的。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;少年是低熵的。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;纯洁是困难的。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;理想是碎的。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;理想是需要拼死拼活拼起来的。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;君子需要慎独。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;电脑不能过量。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;君子+电脑游戏=病毒&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;数学是深奥的。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;数学是简单的。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;实验是主观的。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;模拟是耗脑的。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;胜利是不存在的。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;故事是需要整理的。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;人际鸿沟是深的。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;低级趣味不是低级的。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;</content><category term="Thoughts"></category><category term="chinese"></category><category term="thoughts"></category></entry><entry><title>Writing Python modularly // Python模块化初步</title><link href="http://www.newflaw.com/blog/articles/program/writing-python-modularly-pythonmo-kuai-hua-chu-bu/" rel="alternate"></link><published>2017-06-30T18:35:00+01:00</published><updated>2017-06-30T18:35:00+01:00</updated><author><name>F. Geng</name></author><id>tag:www.newflaw.com,2017-06-30:/blog/articles/program/writing-python-modularly-pythonmo-kuai-hua-chu-bu/</id><summary type="html">&lt;p&gt;First published &lt;a href="http://orengogroup.info/?p=401"&gt;here&lt;/a&gt; for my intern at UCL-ISMB-CATH.
[markdown]&lt;/p&gt;
&lt;h4&gt;Brief:&lt;/h4&gt;
&lt;p&gt;Having the privilege of joining Orengo's group as a summer student, I feel urged to …&lt;/p&gt;</summary><content type="html">&lt;p&gt;First published &lt;a href="http://orengogroup.info/?p=401"&gt;here&lt;/a&gt; for my intern at UCL-ISMB-CATH.
[markdown]&lt;/p&gt;
&lt;h4&gt;Brief:&lt;/h4&gt;
&lt;p&gt;Having the privilege of joining Orengo's group as a summer student, I feel urged to improve my coding as well as documentation skills. Thus I intend to log my coding and thinking in a series of blog posts, on a weekly basis.&lt;/p&gt;
&lt;p&gt;Today's blog post will cover some basics of organising Python code, in the hope of easing future maintenance. We will go through:&lt;/p&gt;
&lt;!--more--&gt;

&lt;ol&gt;
&lt;li&gt;How to import python modules.&lt;/li&gt;
&lt;li&gt;Comparing alternative implementations&lt;/li&gt;
&lt;li&gt;How to write importable python modules.&lt;/li&gt;
&lt;li&gt;Simplistic approach "&lt;code&gt;.py&lt;/code&gt;"&lt;/li&gt;
&lt;li&gt;How to structure your python modules.&lt;/li&gt;
&lt;li&gt;How does import work anyway?&lt;/li&gt;
&lt;/ol&gt;
&lt;h4&gt;1. How to import python modules.&lt;/h4&gt;
&lt;p&gt;In Python, importing a module is common and useful. For example, "&lt;code&gt;numpy&lt;/code&gt;" is a widespread module with handy matrix operations. If numpy is not installed on your machine. Try "&lt;code&gt;pip install numpy&lt;/code&gt;".&lt;/p&gt;
&lt;p&gt;For example, in python do:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt;
&lt;span class="n"&gt;rd&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Random number&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rd&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39; is generated&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;You can also use your own alias when importing a module&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;span class="n"&gt;rd&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Random number&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rd&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39; is generated&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;You can even import a submodule on its own&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy.random&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;random&lt;/span&gt;

&lt;span class="c1"&gt;#### Which is the right one to do now?&lt;/span&gt;
&lt;span class="n"&gt;rd&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;rd&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Random number&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rd&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39; is generated&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Question 1:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;#### Modify the import statement to make the code work&lt;/span&gt;

&lt;span class="c1"&gt;# import numpy.random as random&lt;/span&gt;

&lt;span class="n"&gt;rd&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rand&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Random number&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rd&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39; is generated&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;You can also do "&lt;code&gt;help(np)&lt;/code&gt;" or "&lt;code&gt;help(np.random)&lt;/code&gt;" to read the manual, which would hopefully tell you about the submodules available for call. The above should remind you of how to import a installed module. Note I did not talk about what "&lt;code&gt;import&lt;/code&gt;" does exactly, but this won't affect your usage of the command -- you know how it should look like.&lt;/p&gt;
&lt;p&gt;Now, developers not only need to import installed modules, but also to actually write an importable module. To make it in context, we need a toy example. My favourite toy is cellular automata so I will just outline it here.&lt;/p&gt;
&lt;p&gt;Imagine you got a circular peptide chain of a fixed length, say 12 amino-acid(aa) residues(res). At every residue position, it can have one of the 20 universally-encoded amino acid. Now this protein has some strange behaviour. Every time it is passed from parent to progeny, its sequence change in a deterministic way. Each residue would look at the residue adjacent to it, and decide what aa it become in the next round. We call this process one round of evolution.&lt;/p&gt;
&lt;p&gt;There are 20*20*20 = 8000 possible permutations that could happen, and we need to specify the resultant residue from each of the 8000 permutations. First let's assume the rule is simple, every of them become an Ala (aa_id:1)&lt;/p&gt;
&lt;p&gt;Let's create a python script "&lt;code&gt;main.py&lt;/code&gt;" with the following commands.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;

&lt;span class="c1"&gt;### We fill the rule array with loads of 1&amp;#39;s&lt;/span&gt;
&lt;span class="n"&gt;rule&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt; &lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;

&lt;span class="n"&gt;old&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;19&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;17&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;

&lt;span class="n"&gt;new&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;old&lt;/span&gt;&lt;span class="p"&gt;[:];&lt;/span&gt; &lt;span class="c1"&gt;## Create a independent copy.&lt;/span&gt;
&lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;old&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;old&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;i_lef&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="c1"&gt;### numpy handle -1th entry swiftly as expected&lt;/span&gt;
    &lt;span class="n"&gt;i_rig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="c1"&gt;## We do not want to access 13th entry from a 12-entry array.&lt;/span&gt;

    &lt;span class="c1"&gt;# res = old[ i ]; ### from definition&lt;/span&gt;
    &lt;span class="n"&gt;res_lef&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;old&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="n"&gt;i_lef&lt;/span&gt; &lt;span class="p"&gt;];&lt;/span&gt;
    &lt;span class="n"&gt;res_rig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;old&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="n"&gt;i_rig&lt;/span&gt; &lt;span class="p"&gt;];&lt;/span&gt;

    &lt;span class="c1"&gt;### Look up the rule array&lt;/span&gt;
    &lt;span class="n"&gt;new&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rule&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="n"&gt;res_lef&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;res_rig&lt;/span&gt; &lt;span class="p"&gt;];&lt;/span&gt;

&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;new&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Due to the simplistic rule, we would expect a simple result.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Okay this code is functional. But we feel the updating process is a bit lengthy. It'd be great if we can achieve some condensation, and that's where modules come in.&lt;/p&gt;
&lt;h4&gt;2. How to write importable python modules.&lt;/h4&gt;
&lt;h5&gt;Before making a module, make a function first:&lt;/h5&gt;
&lt;p&gt;Let's forget about modules and functions for a moment, just imagine you could tell python to do:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;

&lt;span class="c1"&gt;### We fill the rule array with loads of 1&amp;#39;s&lt;/span&gt;
&lt;span class="n"&gt;rule&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt; &lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;

&lt;span class="n"&gt;old&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;19&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;17&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;

&lt;span class="c1"&gt;#### One line looks much simpler&lt;/span&gt;
&lt;span class="n"&gt;new&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;evolve&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;old&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rule&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;### Magic happens&lt;/span&gt;

&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;new&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;This one-liner will become handy if we'd like to see the result after 1000 rounds, it will just be&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;

&lt;span class="c1"&gt;### We fill the rule array with loads of 1&amp;#39;s, and use a predefined starting sequence&lt;/span&gt;
&lt;span class="n"&gt;rule&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt; &lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;span class="n"&gt;seq&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;19&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;17&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;

&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;evocount&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="mi"&gt;1000&lt;/span&gt; &lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;new_seq&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;evolve&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;seq&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rule&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;seq&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;new_seq&lt;/span&gt;

&lt;span class="c1"&gt;### both should work&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;seq&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;new_seq&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;This code obviously is not functional yet. Running it throws "&lt;code&gt;NameError: name 'evolve' is not defined&lt;/code&gt;", which makes sense, for we did not define "&lt;code&gt;evolve&lt;/code&gt;" anywhere at all. Define a function in python is straight forward. Let's define this magic called "&lt;code&gt;evolve()&lt;/code&gt;":&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;evolve&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;old&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rule&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;new&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;old&lt;/span&gt;&lt;span class="p"&gt;[:];&lt;/span&gt; &lt;span class="c1"&gt;## Create a independent copy. &lt;/span&gt;
    &lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;old&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;old&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;i_lef&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;  &lt;span class="c1"&gt;### numpy handle -1th entry swiftly as expected&lt;/span&gt;
        &lt;span class="n"&gt;i_rig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="c1"&gt;## We do not want to access 13th entry from a 12-entry array.&lt;/span&gt;

        &lt;span class="c1"&gt;# res = old[ i ]; ### from definition&lt;/span&gt;
        &lt;span class="n"&gt;res_lef&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;old&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="n"&gt;i_lef&lt;/span&gt; &lt;span class="p"&gt;];&lt;/span&gt;
        &lt;span class="n"&gt;res_rig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;old&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="n"&gt;i_rig&lt;/span&gt; &lt;span class="p"&gt;];&lt;/span&gt;

        &lt;span class="c1"&gt;### Look up the rule array&lt;/span&gt;
        &lt;span class="n"&gt;new&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rule&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="n"&gt;res_lef&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;res_rig&lt;/span&gt;  &lt;span class="p"&gt;];&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;new&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;### we return the output of the function to global namespace. &lt;/span&gt;

&lt;span class="n"&gt;rule&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt; &lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;span class="n"&gt;seq&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;19&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;17&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;

&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;evocount&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="mi"&gt;1000&lt;/span&gt; &lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;new_seq&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;evolve&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;seq&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rule&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;seq&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;new_seq&lt;/span&gt;

&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;seq&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Swift! The error was no more, at the expense of introducing a "&lt;code&gt;def&lt;/code&gt;" statement. This "&lt;code&gt;def&lt;/code&gt;" spans 14 lines, which is Okay, but sometimes it can get very lengthy and it destroys the effect of our simplification. Thus it'd be good to replace the "&lt;code&gt;def&lt;/code&gt;" even further with "&lt;code&gt;import&lt;/code&gt;".&lt;/p&gt;
&lt;h5&gt;So let's do some import magic&lt;/h5&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;evolve&lt;/span&gt; &lt;span class="c1"&gt;#### Magic happens&lt;/span&gt;

&lt;span class="n"&gt;rule&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt; &lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;span class="n"&gt;seq&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;19&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;17&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;

&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;evocount&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="mi"&gt;1000&lt;/span&gt; &lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;new_seq&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;evolve&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;seq&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rule&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;seq&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;new_seq&lt;/span&gt;

&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;seq&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;As the module "&lt;code&gt;evolve&lt;/code&gt;" is not defined yet (no magic yet), we'd expect "&lt;code&gt;ImportError: No module named evolve&lt;/code&gt;". So, how on earth do we pack "&lt;code&gt;def&lt;/code&gt;" into a module? A python module is essentially a "&lt;code&gt;.py&lt;/code&gt;" script or a &lt;strong&gt;directory&lt;/strong&gt; containing "&lt;code&gt;.py&lt;/code&gt;" scripts.&lt;/p&gt;
&lt;p&gt;To create a "&lt;code&gt;evolve&lt;/code&gt;" module, let's make a "&lt;code&gt;evolve.py&lt;/code&gt;" under the &lt;strong&gt;same&lt;/strong&gt; directory as "&lt;code&gt;main.py&lt;/code&gt;" created earlier.&lt;/p&gt;
&lt;p&gt;"&lt;code&gt;evolve.py&lt;/code&gt;"&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;evolve&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;old&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rule&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="n"&gt;new&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;old&lt;/span&gt;&lt;span class="p"&gt;[:];&lt;/span&gt; &lt;span class="c1"&gt;## Create a independent copy.&lt;/span&gt;
&lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;old&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;old&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;i_lef&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="c1"&gt;### numpy handle -1th entry swiftly as expected&lt;/span&gt;
    &lt;span class="n"&gt;i_rig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="c1"&gt;## We do not want to access 13th entry from a 12-entry array.&lt;/span&gt;

&lt;span class="c1"&gt;# res = old[ i ]; ### from definition&lt;/span&gt;
&lt;span class="n"&gt;res_lef&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;old&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="n"&gt;i_lef&lt;/span&gt; &lt;span class="p"&gt;];&lt;/span&gt;
&lt;span class="n"&gt;res_rig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;old&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="n"&gt;i_rig&lt;/span&gt; &lt;span class="p"&gt;];&lt;/span&gt;

&lt;span class="c1"&gt;### Look up the rule array&lt;/span&gt;
&lt;span class="n"&gt;new&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rule&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="n"&gt;res_lef&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;res_rig&lt;/span&gt; &lt;span class="p"&gt;];&lt;/span&gt;
&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;new&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;### return the output of the function to global namespace&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Remember to always save your changes in text editor!&lt;/p&gt;
&lt;p&gt;Let's run "&lt;code&gt;main.py&lt;/code&gt;" again. Unfortunately, it still throws an error. "&lt;code&gt;TypeError: 'module' object is not callable&lt;/code&gt;" If you look at the line reported, you should find the "&lt;code&gt;evolve( seq, rule)&lt;/code&gt;" statement in "&lt;code&gt;main.py&lt;/code&gt;". Generally, to "call" "&lt;code&gt;foo&lt;/code&gt;", just means running "&lt;code&gt;foo()&lt;/code&gt;".&lt;/p&gt;
&lt;p&gt;If you remember &lt;strong&gt;Question 1&lt;/strong&gt; from earlier with "&lt;code&gt;random.random()&lt;/code&gt;", you should come up with "&lt;code&gt;evolve.evolve( seq, rule)&lt;/code&gt;" as a solution. To make it clearer, let's change the name of "&lt;code&gt;evolve.py&lt;/code&gt;" to "&lt;code&gt;lib.py&lt;/code&gt;". Correspondingly "&lt;code&gt;main.py&lt;/code&gt;" should change to:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;lib&lt;/span&gt;
&lt;span class="c1"&gt;# from lib import evolve #### Alternative solution&lt;/span&gt;

&lt;span class="n"&gt;rule&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="kp"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt; &lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;span class="n"&gt;seq&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="kp"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;19&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;17&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;

&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;evocount&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="mi"&gt;1000&lt;/span&gt; &lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;new_seq&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;lib&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;evolve&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;seq&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rule&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="c1"&gt;# new_seq = evolve( seq, rule) #### Alternative solution&lt;/span&gt;
    &lt;span class="n"&gt;seq&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;new_seq&lt;/span&gt;

&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;seq&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Generally, it is good practice to keep the module name different from the submodules (like "&lt;code&gt;def&lt;/code&gt;" within the script) contained within. e.g.: Do not place "&lt;code&gt;def evolve():&lt;/code&gt;" in "&lt;code&gt;evolve.py&lt;/code&gt;" to avoid confusing statement like "&lt;code&gt;evolve.evolve()&lt;/code&gt;".&lt;/p&gt;
&lt;h5&gt;3. Organising your modules&lt;/h5&gt;
&lt;p&gt;At the moment everything is under the same directory "&lt;code&gt;.&lt;/code&gt;" . However as your programme get bigger, more and more "&lt;code&gt;.py&lt;/code&gt;" will be popping up, when it would be useful to separate modules for different purposes into different folders, so that you don't go through: "Okay I am gonna run a test suite, but which "&lt;code&gt;.py&lt;/code&gt;" files should I run? Hmm let me have a browse..."&lt;/p&gt;
&lt;p&gt;Too keep things simple, lets assign some names. We don't really care what the root directory "&lt;code&gt;.&lt;/code&gt;" is called , but let's call it "&lt;code&gt;toy&lt;/code&gt;". So at the moment there are two files "&lt;code&gt;toy/main.py&lt;/code&gt;" and "&lt;code&gt;toy/lib.py&lt;/code&gt;".&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;.&lt;/span&gt;
&lt;span class="err"&gt;├── lib.py&lt;/span&gt;
&lt;span class="err"&gt;└── main.py&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Conventionally, we store all easily importable modules into a directory "&lt;code&gt;lib/&lt;/code&gt;" instead of a script. So let's do&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;mkdir lib&lt;/span&gt;
&lt;span class="err"&gt;mv lib.py lib/libA.py&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;.&lt;/span&gt;
&lt;span class="err"&gt;├── lib&lt;/span&gt;
&lt;span class="err"&gt;│   └── libA.py&lt;/span&gt;
&lt;span class="err"&gt;└── main.py&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Runing "&lt;code&gt;main.py&lt;/code&gt;" throws "&lt;code&gt;ImportError: No module named lib&lt;/code&gt;". Python does not automatically recognise directory as importable. We need to flag a directory by placing "__init__.py" under it. Just do&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;touch lib/__init__;.py&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;.&lt;/span&gt;
&lt;span class="err"&gt;├── lib&lt;/span&gt;
&lt;span class="err"&gt;│   ├── __init__.py&lt;/span&gt;
&lt;span class="err"&gt;│   └── libA.py&lt;/span&gt;
&lt;span class="err"&gt;└── main.py&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Now "&lt;code&gt;main.py&lt;/code&gt;" throws "&lt;code&gt;ImportError: cannot import name evolve&lt;/code&gt;". Yah yah, nothing in "&lt;code&gt;lib/&lt;/code&gt;" has the name "&lt;code&gt;evolve&lt;/code&gt;". We need to update the "&lt;code&gt;main.py&lt;/code&gt;" with "&lt;code&gt;from lib.libA import evolve&lt;/code&gt;". Note "&lt;code&gt;import lib.libA.evolve&lt;/code&gt;" would not work because "&lt;code&gt;evolve&lt;/code&gt;" is defined as "&lt;code&gt;def&lt;/code&gt;" and not a script "&lt;code&gt;.py&lt;/code&gt;".&lt;/p&gt;
&lt;p&gt;Cool, now we even have a decent "lib/" folder! Another common directory in Test-Driven-Development (TDD) is "tests/". Let's create some look-alike structure with `&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;mkdir tests&lt;/span&gt;
&lt;span class="err"&gt;cp main.py tests/test1.py&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;.&lt;/span&gt;
&lt;span class="err"&gt;├── lib&lt;/span&gt;
&lt;span class="err"&gt;│   ├── __init__.py&lt;/span&gt;
&lt;span class="err"&gt;│   └── libA.py&lt;/span&gt;
&lt;span class="err"&gt;├── main.py&lt;/span&gt;
&lt;span class="err"&gt;└── tests&lt;/span&gt;
&lt;span class="err"&gt;└── test1.py&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Now in "&lt;code&gt;test1.py&lt;/code&gt;", can we still import normally? Running "&lt;code&gt;tests1.py&lt;/code&gt;" give "&lt;code&gt;ImportError: No module named lib.libA&lt;/code&gt;". By default, "&lt;code&gt;import&lt;/code&gt;" only search the directory where the running script exists, and then any directory on env variable $PYTHONPATH, which itself is default to $PATH if unset.&lt;/p&gt;
&lt;p&gt;Remember the "&lt;code&gt;main.py&lt;/code&gt;" and "&lt;code&gt;test1.py&lt;/code&gt;" are essentially identical, except in different directories. There are many possible fiexes here:
1. include the root directory ("&lt;code&gt;toy/&lt;/code&gt;") on $PATH, allowing "&lt;code&gt;test1.py&lt;/code&gt;" to also access it.
2. Adding a statement in "&lt;code&gt;test1.py&lt;/code&gt;" to alter the $PATH variable on the fly
3. Some other module-based approach (still exploring)&lt;/p&gt;
&lt;p&gt;Approach 2: OTF change to $PATH. See "&lt;code&gt;branch:orig2_tests_opt2&lt;/code&gt;"
Let's add the following to "&lt;code&gt;test1.py&lt;/code&gt;"&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;sys&lt;/span&gt;
&lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;..&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Great! Above concludes my initial effort in organising my Python code, and hopefully reveal the magic behind "&lt;code&gt;import&lt;/code&gt;" a little bit. I believe every python user is familiar with "&lt;code&gt;pip install&lt;/code&gt;", and the frustration where this command fails (Or a worse case: it appears successful, but still shouting up "&lt;code&gt;ImportError&lt;/code&gt;"). After understanding importing, installing a module boils down to place the importable modules on a suitable $PATH. And if your $PATH don't contain your installed module, it is expected to fail. There is also other issue like syntax difference between python2 and python3, but I hope the gist is clear.&lt;/p&gt;
&lt;p&gt;Feng Geng&lt;br /&gt;
Summer Student&lt;br /&gt;
ISMB,UCL&lt;/p&gt;
&lt;p&gt;[/markdown]&lt;/p&gt;</content><category term="program"></category><category term="program"></category><category term="english"></category><category term="python"></category></entry><entry><title>风城纪事·偏见</title><link href="http://www.newflaw.com/blog/articles/thoughts/feng-cheng-ji-shi-pian-jian/" rel="alternate"></link><published>2017-06-28T22:21:00+01:00</published><updated>2017-06-28T22:21:00+01:00</updated><author><name>F. Geng</name></author><id>tag:www.newflaw.com,2017-06-28:/blog/articles/thoughts/feng-cheng-ji-shi-pian-jian/</id><summary type="html">&lt;p&gt;“便使我千刀万剐，永劫不复，又有谁会在意呢？”我猜这句话应该符合一个抑郁患者的语气。&lt;/p&gt;
&lt;p&gt;中心化的下一阶段，是与他者共同构成一个更大的中心，其核心前提在于相互的评价和影响。这种评价，即是这里所谓的“偏见”。最简单的偏见，当然是主体对主体自身的偏见。前述的弥赛亚态，就可以认为是一种自指的偏见。&lt;/p&gt;
&lt;!--more--&gt;

&lt;p&gt;由于评价必然有一个发出者，因此评价不可避免地带有评价者的价值判断，我们由此可以推断所有评价都是一种偏见。偏见不必是负面的，这么命名主要是彰显其发出者。譬如，学生向黎曼请教积分的问题，黎曼随手甩了自己的论文给他，并且在多处复杂的推论处使用了“显然”、“易证 …&lt;/p&gt;</summary><content type="html">&lt;p&gt;“便使我千刀万剐，永劫不复，又有谁会在意呢？”我猜这句话应该符合一个抑郁患者的语气。&lt;/p&gt;
&lt;p&gt;中心化的下一阶段，是与他者共同构成一个更大的中心，其核心前提在于相互的评价和影响。这种评价，即是这里所谓的“偏见”。最简单的偏见，当然是主体对主体自身的偏见。前述的弥赛亚态，就可以认为是一种自指的偏见。&lt;/p&gt;
&lt;!--more--&gt;

&lt;p&gt;由于评价必然有一个发出者，因此评价不可避免地带有评价者的价值判断，我们由此可以推断所有评价都是一种偏见。偏见不必是负面的，这么命名主要是彰显其发出者。譬如，学生向黎曼请教积分的问题，黎曼随手甩了自己的论文给他，并且在多处复杂的推论处使用了“显然”、“易证”，但是每一个命题，实际上都需要一个专业数学家认真推导才能得出。由此可知，“易证”这个词是带有很强主观判断的。&lt;/p&gt;
&lt;p&gt;虽然不是必然，但是弥赛亚态下的人常常对自己有着极大的偏见，&lt;/p&gt;
&lt;p&gt;从执行的角度看，偏见是一种方向的度量——我们期望塑造或是消解某种偏见。与之相对的，是不以偏见为转移的行为，也就是前述的心流态——任何人的价值判断都与此时的行为无关，行为不再以偏见为导向，而是完全由人的潜意识和弥赛亚式的精神状态。这种基于自我的“无我”，源于偏见，但却又高于偏见。&lt;/p&gt;
&lt;p&gt;譬如弹琴练习一首曲子，如若要考虑曲子的欣赏性，那么任何一个杂音都是不可接受的失误，但如若只是为了抒发脑海中的旋律，那么一两个杂音并不应该阻挠抒发的进程。可以看到，为了欣赏性的演奏是以偏见为导向的，而抒发性的演奏不以欣赏性为目标，而是尽可能完好地保存和表达灵感为目标，我们可以说，对灵感的保存，是一种“无我”的行为。尽管从长远看，可以猜测这隐含了“灵感是将具有欣赏性的”这种先验的信念，因而驱动了记录灵感的这个过程，但是我们也可以说对灵感的记录并不必导出“具有欣赏性”这个结果，所以记录灵感可以看成有一个独立动机的行为。这种动机在最开始可能依赖于偏见而存在，但是在偏见消失以后，这种动机找到了自己独立的意义。&lt;/p&gt;
&lt;p&gt;前两天看了“动机在杭州”老师关于批判的讨论，他指出了人们习惯的用自己的框架来中和外部现象的习惯（“批判”），而不是放下成见去倾听，感受并尝试理解这个外部现象（“感应”）。显然的是，成见的存在允许将注意力导向最有价值的目标，简化了需要处理的信息，但是其副作用就是沟通质量的下降——倾诉者没有享受到被理解的快感，反而被倒打一耙而陷入了更加不利的境地——“你说的这些都很正常啊 ，发生在你身上也没什么不对的呀？你没有受到什么不公平嘛！”（简言之，你是自作自受）。我们可以尝试穷举倾诉的结果：&lt;/p&gt;
&lt;p&gt;1.倾听者对倾诉者的叙述和归因表示理解并赞同。
2.倾听者对倾诉者的归因表示理解但不赞同
3.倾听者对倾诉者的归因表示不理解和不赞同
4.倾听者对倾诉者的归因表示不理解但是赞同&lt;/p&gt;
&lt;p&gt;可以看到，倾诉的第一个要素是是否理解倾诉者的情感和逻辑，第二个是在道德层面上是否支持这种情感和逻辑。当然，不排除这种支持是暂时的，容易叛变的。&lt;/p&gt;
&lt;p&gt;2017年6月4日
伦敦&lt;/p&gt;</content><category term="thoughts"></category><category term="chinese"></category><category term="thoughts"></category></entry><entry><title>风城纪事·骤雨</title><link href="http://www.newflaw.com/blog/articles/thoughts/feng-cheng-ji-shi-zou-yu/" rel="alternate"></link><published>2017-06-02T15:56:00+01:00</published><updated>2017-06-02T15:56:00+01:00</updated><author><name>F. Geng</name></author><id>tag:www.newflaw.com,2017-06-02:/blog/articles/thoughts/feng-cheng-ji-shi-zou-yu/</id><summary type="html">&lt;p align="left"&gt;&lt;span style="color: #262626;"&gt;&lt;span style="font-family: Helvetica, sans-serif;"&gt;&lt;span style="font-size: medium;"&gt;&lt;span lang="zh-CN"&gt;刚坐下来，黑压压的云就下起了毫无情面的大雨。还好我出门前备了雨披，不然可真是“问君能有几多愁”了。我在伦敦大学学院（&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Helvetica, sans-serif;"&gt;&lt;span style="font-size: medium;"&gt;UCL&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Helvetica, sans-serif;"&gt;&lt;span style="font-size: medium;"&gt;&lt;span lang="zh-CN"&gt;）图书馆的会员还有七天就要到期了，要归还的书还真是不少，不过如若明年仍在这里读书，那么这次离别也就没那么真诚。&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;

&lt;!--more--&gt;

&lt;p align="left"&gt;&lt;span style="color: #262626;"&gt;&lt;span style="font-family: Helvetica, sans-serif;"&gt;&lt;span style="font-size: medium;"&gt;&lt;span lang="zh-CN"&gt;雨是一样极神奇的东西。当然，我指的是不会落到我身上的那种雨——落到我身上，我也就无心欣赏了。这雨打万物的声音我是熟悉的，它让我想起某次在横店的一个半夜，我孤身一人在一个诡异的情侣酒店里听着热水器的噪音无法入眠。那噪音不知疲倦，纵使我改换房间仍逃不出它的魔爪。不禁恨恨地想：来这旅店下榻的情侣，大概都因为半夜睡不着而闹别扭分散了吧 …&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;</summary><content type="html">&lt;p align="left"&gt;&lt;span style="color: #262626;"&gt;&lt;span style="font-family: Helvetica, sans-serif;"&gt;&lt;span style="font-size: medium;"&gt;&lt;span lang="zh-CN"&gt;刚坐下来，黑压压的云就下起了毫无情面的大雨。还好我出门前备了雨披，不然可真是“问君能有几多愁”了。我在伦敦大学学院（&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Helvetica, sans-serif;"&gt;&lt;span style="font-size: medium;"&gt;UCL&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Helvetica, sans-serif;"&gt;&lt;span style="font-size: medium;"&gt;&lt;span lang="zh-CN"&gt;）图书馆的会员还有七天就要到期了，要归还的书还真是不少，不过如若明年仍在这里读书，那么这次离别也就没那么真诚。&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;

&lt;!--more--&gt;

&lt;p align="left"&gt;&lt;span style="color: #262626;"&gt;&lt;span style="font-family: Helvetica, sans-serif;"&gt;&lt;span style="font-size: medium;"&gt;&lt;span lang="zh-CN"&gt;雨是一样极神奇的东西。当然，我指的是不会落到我身上的那种雨——落到我身上，我也就无心欣赏了。这雨打万物的声音我是熟悉的，它让我想起某次在横店的一个半夜，我孤身一人在一个诡异的情侣酒店里听着热水器的噪音无法入眠。那噪音不知疲倦，纵使我改换房间仍逃不出它的魔爪。不禁恨恨地想：来这旅店下榻的情侣，大概都因为半夜睡不着而闹别扭分散了吧，也难怪它的生意这样的冷清，才需要从公车站靠黑车拉客来生存。我走在楼道里，建筑的结构显然是农家宅基地的构造，所以隔音效果才那样差。我越发地确定这是一个陷阱，于是查了最近的落脚点，理了行李到前台退了房，在半夜一点离开了这诡异的地方。&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p align="left"&gt;&lt;span style="color: #262626;"&gt;&lt;span style="font-family: Helvetica, sans-serif;"&gt;&lt;span style="font-size: medium;"&gt;&lt;span lang="zh-CN"&gt;再住下的一个旅馆，窗外是潺潺的小溪，那小溪的声音便和这雨声相似，有一种安抚人心的力量。奇怪的是，我一点也不觉得它嘈杂，睡得很深，很沉。&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p align="left"&gt;&lt;span style="color: #262626;"&gt;&lt;span style="font-family: Helvetica, sans-serif;"&gt;&lt;span style="font-size: medium;"&gt;&lt;span lang="zh-CN"&gt;窗外，隆隆的雷声正在思忖下一刻的天气。滴答作响的雨，从不停歇。它一会儿细，一会儿密，哗啦啦地撞在一切暴露的平面曲面之上。它宣示着自然对此地的占领，宣示着对一切生物的驱逐。没有情感，没有欲望，没有对未来的期待，它只是静静地下着。也因此，它大概是有生命的。&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p align="left"&gt;&lt;span style="color: #262626;"&gt;&lt;span style="font-family: Helvetica, sans-serif;"&gt;&lt;span style="font-size: medium;"&gt;&lt;span lang="zh-CN"&gt;伦敦大学学院科学图书馆
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #262626;"&gt;&lt;span style="font-family: Helvetica, sans-serif;"&gt;&lt;span style="font-size: medium;"&gt;2017&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Helvetica, sans-serif;"&gt;&lt;span style="font-size: medium;"&gt;&lt;span lang="zh-CN"&gt;年&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Helvetica, sans-serif;"&gt;&lt;span style="font-size: medium;"&gt;6&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Helvetica, sans-serif;"&gt;&lt;span style="font-size: medium;"&gt;&lt;span lang="zh-CN"&gt;月&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Helvetica, sans-serif;"&gt;&lt;span style="font-size: medium;"&gt;2&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Helvetica, sans-serif;"&gt;&lt;span style="font-size: medium;"&gt;&lt;span lang="zh-CN"&gt;日&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;</content><category term="thoughts"></category><category term="chinese"></category><category term="thoughs"></category></entry><entry><title>风城纪事·中心</title><link href="http://www.newflaw.com/blog/articles/thoughts/feng-cheng-ji-shi-zhong-xin/" rel="alternate"></link><published>2017-05-30T10:58:00+01:00</published><updated>2017-05-30T10:58:00+01:00</updated><author><name>F. Geng</name></author><id>tag:www.newflaw.com,2017-05-30:/blog/articles/thoughts/feng-cheng-ji-shi-zhong-xin/</id><summary type="html">&lt;p&gt;&lt;span style="font-family: Helvetica, sans-serif;"&gt;&lt;span style="font-size: medium;"&gt;&lt;span lang="zh-CN"&gt;我常常迷惑&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Helvetica, sans-serif;"&gt;&lt;span style="font-size: medium;"&gt;, &lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Helvetica, sans-serif;"&gt;&lt;span style="font-size: medium;"&gt;&lt;span lang="zh-CN"&gt;偏见和思想的区别到底在哪里呢&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Helvetica, sans-serif;"&gt;&lt;span style="font-size: medium;"&gt;? &lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Helvetica, sans-serif;"&gt;&lt;span style="font-size: medium;"&gt;&lt;span lang="zh-CN"&gt;如王小波所言：&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: #262626;"&gt;“&lt;span style="font-family: Helvetica, sans-serif;"&gt;&lt;span style="font-size: medium;"&gt;&lt;span lang="zh-CN"&gt;那一天我二十一岁，在我一生的黄金时代，我有好多奢望。我想爱，想吃，还想在一瞬间变成天上半明半暗的云&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Helvetica, sans-serif;"&gt;。……我觉得自己会永远生猛下去，什么也锤不了我。”（《黄金时代》）&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: Helvetica, sans-serif;"&gt;&lt;span style="font-size: medium;"&gt;&lt;span lang="zh-CN"&gt;&lt;span style="color: #262626;"&gt;这种唯我独尊的，弥赛亚式的自觉，大家大概都熟悉。在这种精神状态下，人是不会质疑自己的判断和选择的，让我们暂且称这种状态为“弥赛亚”态。与之比较流行的相关概念，大概是“中二”症侯，不过 …&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;span style="font-family: Helvetica, sans-serif;"&gt;&lt;span style="font-size: medium;"&gt;&lt;span lang="zh-CN"&gt;我常常迷惑&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Helvetica, sans-serif;"&gt;&lt;span style="font-size: medium;"&gt;, &lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Helvetica, sans-serif;"&gt;&lt;span style="font-size: medium;"&gt;&lt;span lang="zh-CN"&gt;偏见和思想的区别到底在哪里呢&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Helvetica, sans-serif;"&gt;&lt;span style="font-size: medium;"&gt;? &lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Helvetica, sans-serif;"&gt;&lt;span style="font-size: medium;"&gt;&lt;span lang="zh-CN"&gt;如王小波所言：&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="color: #262626;"&gt;“&lt;span style="font-family: Helvetica, sans-serif;"&gt;&lt;span style="font-size: medium;"&gt;&lt;span lang="zh-CN"&gt;那一天我二十一岁，在我一生的黄金时代，我有好多奢望。我想爱，想吃，还想在一瞬间变成天上半明半暗的云&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Helvetica, sans-serif;"&gt;。……我觉得自己会永远生猛下去，什么也锤不了我。”（《黄金时代》）&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: Helvetica, sans-serif;"&gt;&lt;span style="font-size: medium;"&gt;&lt;span lang="zh-CN"&gt;&lt;span style="color: #262626;"&gt;这种唯我独尊的，弥赛亚式的自觉，大家大概都熟悉。在这种精神状态下，人是不会质疑自己的判断和选择的，让我们暂且称这种状态为“弥赛亚”态。与之比较流行的相关概念，大概是“中二”症侯，不过&lt;/span&gt;&lt;span style="color: #262626;"&gt;“中二”的贬义和偏见太强，就不直接拿来了。但是弥赛亚和中二的共同之处，就是自我的中心化&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Helvetica, sans-serif;"&gt;&lt;span style="font-size: medium;"&gt;&lt;span style="color: #262626;"&gt;(Centralisation)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Helvetica, sans-serif;"&gt;&lt;span style="font-size: medium;"&gt;&lt;span lang="zh-CN"&gt;&lt;span style="color: #262626;"&gt;。这种中心化，不必是糟糕的，甚至可能是人极为基本的&lt;/span&gt;&lt;span style="color: #262626;"&gt;一种性质。&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;!--more--&gt;

&lt;p&gt;&lt;span style="font-family: Helvetica, sans-serif;"&gt;&lt;span style="font-size: medium;"&gt;&lt;span lang="zh-CN"&gt;&lt;span style="color: #262626;"&gt;中心化，最突出的效果就是确定了“我”。这就好像在物理中一旦选取了一个坐标系&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: medium;"&gt;/&lt;/span&gt;&lt;span style="font-size: medium;"&gt;&lt;span lang="zh-CN"&gt;参照系，世间一切万物就突然都有了度量（当然还需要确定一个单位长度）。从实用的角度来说，中心化为归纳提供了一个前提（“归纳”此处指对万物的分类和组织），在这种前提下生成的认识和推论，是不能离开这个前提而存在的。允许高效的归纳和处理，自然就成了中心化的一大优势（此处表述模糊）。我想把这个概念和“心流”（&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: medium;"&gt;Mind Flow&lt;/span&gt;&lt;span style="font-size: medium;"&gt;&lt;span lang="zh-CN"&gt;）联系起来，也就是说在心流状态下，中心化是一个本质。&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: Helvetica, sans-serif;"&gt;&lt;span style="font-size: medium;"&gt;&lt;span lang="zh-CN"&gt;&lt;span style="color: #262626;"&gt;然而中心化在中二现象中&lt;/span&gt;&lt;span style="color: #262626;"&gt;显然是造成了负面效果的。这是为什么呢？中二者被诟病，大多是因为它不能考虑别人的处境和想法，一意孤行，唯我独尊，顺我者昌逆我者亡（这些词带了点帝王气，但是注意这里只讨论国中二年级现象，帝王不在范围内）。要解释中心化和这个效果的关系，我们需要引入“决策”。在中二者的决策中，他者的利益是全然不在考虑范围内的，只有中心的利益是重要的，这里利益可以是各个方面的，如经济利益，社交利益，心理&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Helvetica, sans-serif;"&gt;&lt;span style="font-size: medium;"&gt;&lt;span style="color: #262626;"&gt;/&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: medium;"&gt;&lt;span lang="zh-CN"&gt;情感利益。当然，鉴于中二时常伴随价值观的紊乱，我们有理由怀疑有些中二现象实际上源于对他对利益的定义迥异于主流，所以尽管他们考虑决策时会考虑他者的利益（有同理心），但是他所考虑的利益并不符合他者所考虑的利益。无论如何，我们认为中二现象并不是中心化的必然产物，但中心化是中二现象的前提。只要主体在中二的基础上改进其决策准则并考虑他者的利益，那么中二就自然&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #262626;"&gt;消失了，但这并不伴随中心化的消失。&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: Helvetica, sans-serif;"&gt;&lt;span style="font-size: medium;"&gt;&lt;span lang="zh-CN"&gt;&lt;span style="color: #262626;"&gt;刚刚讨论到了中心化和心流之间的关系，那先聊一下我所了解的心流吧。心流有这样三个特征：&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: Helvetica, sans-serif;"&gt;&lt;span style="font-size: medium;"&gt;&lt;span lang="zh-CN"&gt;&lt;span style="color: #262626;"&gt;第一是其连续性：一旦中途被打断，需要很长时间恢复。比如大家所熟知的学术写作或者阅读过程，如果你读文献的时候断断续续，一会儿回回邮件，一会儿刷刷社交，那么进展将是缓慢的，反复多了人就容易沮丧并且放弃。&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: Helvetica, sans-serif;"&gt;&lt;span style="font-size: medium;"&gt;&lt;span lang="zh-CN"&gt;&lt;span style="color: #262626;"&gt;第二是全神贯注：进入心流态的人是不怎么注意时间的流逝的。这点在沉浸于游戏中的玩家，沉浸于音乐中的乐手（包括演奏者或者作曲家），沉浸于推导中的数学家，沉浸于博弈中的商人政客，都是存在的。在沉浸状态中，人从来不会感到无聊，也不会为等待而感到焦急，常常是“山中方一日，世上已千年”，这也导致了前述的连续性。&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: Helvetica, sans-serif;"&gt;&lt;span style="font-size: medium;"&gt;&lt;span lang="zh-CN"&gt;&lt;span style="color: #262626;"&gt;第三是无我性：心流态下的人很少关注自己的生理或者社交（心理）需求。所以玩家和乐手们常常一玩起来就忘记了睡觉，推导者忘记了走路和吃饭，博弈者忘记了对道德的遵守，也就导致了表象的废寝忘食和礼崩乐坏。需要注意，无我性可以视作中心化的一种特例，这时中心化对归纳的加成是被保留了的，但是在决策上被心流的目标所取代，也就显现出了无我的状态。无我也是全神贯注的一个结果。&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: Helvetica, sans-serif;"&gt;&lt;span style="font-size: medium;"&gt;&lt;span lang="zh-CN"&gt;&lt;span style="color: #262626;"&gt;讨论到这里，中心化的基本效果大致明了了，那么又是怎么联系到“偏见”和“思想”上面的呢&lt;/span&gt;&lt;span style="color: #262626;"&gt;？这时候，我们需要切换到“他者”的视角&lt;/span&gt;&lt;span style="color: #262626;"&gt;，来评价“主体”的一切决策和言论。这种评价和互动的能力，是形成一&lt;/span&gt;&lt;span style="color: #262626;"&gt;个更大的思维共同体的基础。&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: Helvetica, sans-serif;"&gt;&lt;span style="font-size: medium;"&gt;&lt;span lang="zh-CN"&gt;&lt;span style="color: #262626;"&gt;这时候的中心&lt;/span&gt;&lt;span style="color: #262626;"&gt;，就更庞大了。&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;</content><category term="thoughts"></category><category term="chinese"></category><category term="thoughts"></category></entry><entry><title>Calc_Temp: A pragmatic algorithm to classify 2D-NTCA // Calc_Temp:一个实用性的2D-NTCA 分类器</title><link href="http://www.newflaw.com/blog/articles/maths/calc_temp-a-pragmatic-algorithm-to-classify-2d-ntca-calc_tempyi-ge-shi-yong-xing-de-2d-ntca-fen-lei-qi/" rel="alternate"></link><published>2017-03-22T13:55:00+00:00</published><updated>2017-03-22T13:55:00+00:00</updated><author><name>F. Geng</name></author><id>tag:www.newflaw.com,2017-03-22:/blog/articles/maths/calc_temp-a-pragmatic-algorithm-to-classify-2d-ntca-calc_tempyi-ge-shi-yong-xing-de-2d-ntca-fen-lei-qi/</id><summary type="html">&lt;p&gt;I recently integrated my understanding of spatial fluctuation to produce a automatic classifier for 2D non-totalistic cellular automata. It's now available as a git repository …&lt;/p&gt;</summary><content type="html">&lt;p&gt;I recently integrated my understanding of spatial fluctuation to produce a automatic classifier for 2D non-totalistic cellular automata. It's now available as a git repository. I am seeking to implement it on a web server in the near future.&lt;/p&gt;
&lt;p&gt;&lt;a href="https://github.com/shouldsee/calc_temp"&gt;github repo&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;An example of output is shown &lt;a href="https://flaw.000webhostapp.com/calc_temp/example.html"&gt;here(link broken)&lt;/a&gt;&lt;/p&gt;</content><category term="maths"></category><category term="release"></category><category term="automata"></category><category term="maths"></category><category term="short"></category></entry><entry><title>A simple method to classify CA // 一个简单的CA分类方法</title><link href="http://www.newflaw.com/blog/articles/maths/a-simple-method-to-classify-ca-yi-ge-jian-dan-de-cafen-lei-fang-fa/" rel="alternate"></link><published>2017-03-18T15:42:00+00:00</published><updated>2017-03-18T15:42:00+00:00</updated><author><name>F. Geng</name></author><id>tag:www.newflaw.com,2017-03-18:/blog/articles/maths/a-simple-method-to-classify-ca-yi-ge-jian-dan-de-cafen-lei-fang-fa/</id><summary type="html">&lt;p&gt;Recall a CA rule &lt;span class="math"&gt;\(rule\)&lt;/span&gt; project a circular-boundary state space &lt;span class="math"&gt;\(S\)&lt;/span&gt; back to it self, that is&lt;/p&gt;
&lt;p&gt;$rule: S\rightarrow S, aka, x_{t+1 …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Recall a CA rule &lt;span class="math"&gt;\(rule\)&lt;/span&gt; project a circular-boundary state space &lt;span class="math"&gt;\(S\)&lt;/span&gt; back to it self, that is&lt;/p&gt;
&lt;p&gt;$rule: S\rightarrow S, aka, x_{t+1}=rule(x_t), x_t \in S, x_{t+1} \in S $&lt;/p&gt;
&lt;p&gt;where &lt;span class="math"&gt;\(S = { 0, 1 }^n\)&lt;/span&gt;, and more strictly &lt;span class="math"&gt;\(x_t: [1,2,...,n] \rightarrow {0,1} .\)&lt;/span&gt;, for simplicity we let &lt;span class="math"&gt;\(\phi = [1,2,...,n]\)&lt;/span&gt;, thus $x = x(\phi) $&lt;/p&gt;
&lt;p&gt;In practical, we take n=20^2=400;&lt;/p&gt;
&lt;!--more--&gt;

&lt;p&gt;Consider &lt;span class="math"&gt;\(x_S(\phi_S)\)&lt;/span&gt; where &lt;span class="math"&gt;\(\phi_S=[1, 2, ..., n] \times [1, 2, ..., card(S)], \ x_S:\phi_S \rightarrow {0,1}\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;In practical, we sought a big enough representative subset, &lt;span class="math"&gt;\(S_r\)&lt;/span&gt; from &lt;span class="math"&gt;\(S\)&lt;/span&gt;, so that&lt;/p&gt;
&lt;p&gt;&lt;span class="math"&gt;\(x_S(\phi_S)\approx x_{S_r}(\phi_{S_r})\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Denote &lt;span class="math"&gt;\(rule(rule(x))=rule^2(x)\)&lt;/span&gt;, we have&lt;/p&gt;
&lt;p&gt;&lt;span class="math"&gt;\(rule(rule^t(x))=rule^{n+1}(x)\)&lt;/span&gt;,&lt;/p&gt;
&lt;p&gt;We then define a profile &lt;span class="math"&gt;\(\lambda: [0, 1, 2, 3, ......] \rightarrow [0, 1]\)&lt;/span&gt; with Pearson correlation so that&lt;/p&gt;
&lt;p&gt;&lt;span class="math"&gt;\(\lambda(t) =( \rho[x_S,y^t_S]) ^2= ({Cov[x_S, \ y^t_S]\over\sigma[x_S] \cdot \sigma[y^t_S]})^2[/latex], where $y^t_S=rule^n(x_S)\)&lt;/span&gt;, &lt;span class="math"&gt;\(\sigma[X]\)&lt;/span&gt; denotes standard deviation of X and Cov[X,Y] denotes covariance between X and Y.&lt;/p&gt;
&lt;p&gt;We assert that &lt;span class="math"&gt;\(\lambda(t)\)&lt;/span&gt; classify the dynamics of the CA rule by capturing the periodic behavior in the underlying dynamics.&lt;/p&gt;
&lt;p&gt;Importantly, we can find a good &lt;span class="math"&gt;\(S_r\)&lt;/span&gt; by taking a random &lt;span class="math"&gt;\(S_{r0}\)&lt;/span&gt; and obtain&lt;/p&gt;
&lt;p&gt;&lt;span class="math"&gt;\(S_r = rule^T(S_{r0})\)&lt;/span&gt; where T is a variable parameter.&lt;/p&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</content><category term="maths"></category><category term="maths"></category><category term="automata"></category><category term="english"></category></entry><entry><title>What is Information in biology?// 生物中的信息是什么</title><link href="http://www.newflaw.com/blog/articles/thoughts/what-is-information-in-biology-sheng-wu-zhong-de-xin-xi-shi-shi-yao/" rel="alternate"></link><published>2017-03-08T01:46:00+00:00</published><updated>2017-03-08T01:46:00+00:00</updated><author><name>F. Geng</name></author><id>tag:www.newflaw.com,2017-03-08:/blog/articles/thoughts/what-is-information-in-biology-sheng-wu-zhong-de-xin-xi-shi-shi-yao/</id><summary type="html">&lt;p&gt;写这篇文章的起因是：失眠，想了太多。主要在想密度涨落如何能够应用到实际生物研究中&lt;/p&gt;
&lt;p&gt;有几个点：
&lt;ol&gt;
    &lt;li&gt;能不能对CA建构一个自指，或者说，能不能建造出一个能够改变自身规则的CA？ CA规则的一个有趣之处就在于，两个东西之间的互动是完全由这两个东西自身决定的。也就是说，它们的互动不需要借助一个更加基础的规则(Fundmental Law，典型的还原论)，而仅仅取决于这两个东西自身的性质。往宽了讲，两个蛋白质的相互作用，也不应该取决于其结构内部的细节，而应该取决于这两个蛋白质本身所蕴含的信息。&lt;/li&gt;
    &lt;li&gt;基于我目前的实验，我想做一个比较宽泛的陈述：信息存在于时空的涨落/不均匀性。这个命题还可以换种方式陈述 …&lt;/li&gt;&lt;/ol&gt;&lt;/p&gt;</summary><content type="html">&lt;p&gt;写这篇文章的起因是：失眠，想了太多。主要在想密度涨落如何能够应用到实际生物研究中&lt;/p&gt;
&lt;p&gt;有几个点：
&lt;ol&gt;
    &lt;li&gt;能不能对CA建构一个自指，或者说，能不能建造出一个能够改变自身规则的CA？ CA规则的一个有趣之处就在于，两个东西之间的互动是完全由这两个东西自身决定的。也就是说，它们的互动不需要借助一个更加基础的规则(Fundmental Law，典型的还原论)，而仅仅取决于这两个东西自身的性质。往宽了讲，两个蛋白质的相互作用，也不应该取决于其结构内部的细节，而应该取决于这两个蛋白质本身所蕴含的信息。&lt;/li&gt;
    &lt;li&gt;基于我目前的实验，我想做一个比较宽泛的陈述：信息存在于时空的涨落/不均匀性。这个命题还可以换种方式陈述：一个完全均匀的时空是不包任何含信息的。 虽然说科学界公认的遗传物质是DNA，但是很难说这个论点对我们解释生命起到了多大帮助。相反的，越来越多的非DNA调控方式正在被发现，以至于到了需要修改中心法则的时候。&lt;/li&gt;
    &lt;li&gt;我比较期待的一些事：
&lt;ol&gt;
    &lt;li&gt;RNA生命的复活：也就是说不使用蛋白质进行新陈代谢，而是只使用RNA和DNA作为工具传宗接代。&lt;/li&gt;
    &lt;li&gt;更加高效且逼真的生命模拟器：这需要我们把生命行为的信息组分高度抽象出来。&lt;/li&gt;
    &lt;li&gt;以信息交流为基础的新医疗模式：因为生命的本质其实是信息的传递，任何化学组分或者蛋白质都仅仅是信息的载体，那么任何疾病都可以看作是信息处理的结果，那么也应当通过建构适当的信息载体进行干涉。&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
    &lt;li&gt;死或生？
&lt;ol&gt;
    &lt;li&gt;生命的本征特性是什么？ 什么样的东西是死的？什么样的东西是活的？我给出的答案仍然基于我对CA的理解：不能接受外界信息的东西是死的，能对外界信息作出反应的是活的。考虑这样一个思想实验：你手上有一个细菌，现在让你杀死它，你有哪些方法可以达成这个目标？(a)在细胞膜上打个洞（可以是用Ampicillin），细菌因物质泄漏而死 (b) 给细菌吃点毒素，阻挠它的蛋白质生产，细菌失去自我调控能力而死 (c) 将细菌加温到1000摄氏度，细菌因细胞膜破裂而死（其实这个死法比较难分析）。（注意这里我们可以重新定义生命：生命就是，可以死去的东西，这个定义可以和信息定义做一个比较）&lt;/li&gt;
    &lt;li&gt;我最喜欢的方法其实是（b）喂毒药。原因是这样的，你只能给生命喂毒药。比如说石头没有生命，我让你给石头喂毒药，你就算拿石头砸自己的脑袋也想不出来。毒药之所以为毒，是因为它具备调控这个系统的信息。 也就是说，毒药是能和生命进行有趣的互动的，而进行这种互动的能力本身，就是生命的一个特征。我想把这种互动能力看作是这个生命系统的记忆（注意我这里引入了两个新的概念：系统和记忆）。 那么现在问题就好办多了，生命的定义就是，能对特定刺激作出特定反应的东西，更特定地说，是这个从“刺激”到“反应”的映射。&lt;/li&gt;
    &lt;li&gt;虽然这个定义看起来真的一点都不起眼，但我想提它所隐含的内容：这个映射是由某种时空不均性所刻画的。比如说一个细菌想要分裂增殖，怎么分裂呢？它得去查自己的DNA，然后按照DNA合成出mRNA，再转录成蛋白质，然后这些蛋白质在合适的信号调节下可以组织出一场分裂增殖事件。着眼于这个过程，信息都在哪里呢？&lt;/li&gt;
    &lt;li&gt;DNA的序列铁定是信息没错了，但是细胞又怎么知道如何翻译DNA呢？这有点像鸡和蛋的问题，但我想简单地回答：翻译方法蕴含在RNA合成酶里（RNAP,负责把DNA翻译成RNA）。也就是说，RNAP本身蕴含了把DNA翻译成RNA的方法。而这个方法是有一定限制的：RNAP只知道在原料充足，信号正常的情况下翻译传统的DNA，如果我们把DNA换成XNA，RNAP是不知道怎么翻译它的。类似的，核糖体也只知道如何把mRNA翻译成蛋白质，而不知道怎么把mRNA做成核糖酶(Ribozyme)以建构RNA生命。&lt;/li&gt;
    &lt;li&gt;回到毒药问题，显然核糖体和RNAP的工作都需要大量调控，因为在不同的情况下细胞会需要用不同的方式读取不同的信息。 这些信息大部分是要通过化学信号的方式传递的。那么毒素起的作用大概是：给这些玩意儿传递错误的信息。（如何定义“错误”又是一个大题目）&lt;/li&gt;
    &lt;li&gt;那么究竟如何定义毒药所蕴含的信息呢？显然我们最好不要用毒药对生命的结果作为定义毒药的方法，因为这将导致循环论证。当今的结构/分子生物学认为，毒药可以结合到某些受体上，使它们失去原本的生物学活性。这相当于在说，毒药会阻断信息流，比如毒药结合到了核糖体上，使它稳定在了关闭状态，我们就可以说，毒药阻断了核糖体对启动信息作出反应的能力。&lt;/li&gt;
    &lt;li&gt;鉴于目前分子生物学是完全基于分子结构的，接下来的问题就是，如何通过毒药的共性推导出信息的形式？这就要提到涨落问题了，因为涨落其实是信息的一种基本表现形式，我猜想，毒药阻断信息流的过程在某种程度上改变了某个涨落的性质，而这应该是可以被观测到的。&lt;/li&gt;
    &lt;li&gt;我不喜欢用化学平衡来解释生物现象，尤其是用平衡来解释毒药和核糖体的结合，因为取平衡态的过程显然是丢失了信息的，然而自然选择告诉我们，生命必然会尽一切机会构造各种信息流。但是把涨落加进来也不是件容易的事，我们可以考虑核糖体浓度的涨落，也可以考虑单个核糖体电子密度的涨落。现在问题的关键，就在于建立一个通用的联系涨落和信息的办法，而我相信这正是元胞自动机存在的意义。更具体的，什么样的涨落系统可以储存和沟通更多的信息？涨落在哪些方面上是脆弱的？毒药有没有改变涨落的这些性质？&lt;/li&gt;
    &lt;li&gt;在这个过程中，我们或许还可以顺带解决生命的不确定性。或者说我们可以预测任何操作成功的概率，因为这应该是涨落最擅长处理的。&lt;/li&gt;
    &lt;li&gt;待续&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
    &lt;li&gt;发现这个问题前人稍微有探讨过 &lt;a href="https://www.quantamagazine.org/20170126-information-theory-and-the-foundation-of-life/"&gt;QuantaMag&lt;/a&gt;/&lt;a href="http://www.huanqiukexue.com/a/qianyan/shengwu__yixue/2017/0221/26978.html"&gt;环球科学译文&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;&lt;/p&gt;</content><category term="thoughts"></category><category term="bioinformatics"></category><category term="thoughts"></category><category term="chinese"></category></entry><entry><title>On the discovery of density fluctuation in Cellular Automata//写在发现元胞自动机密度涨落之际</title><link href="http://www.newflaw.com/blog/articles/maths/on-the-discovery-of-density-fluctuation-in-cellular-automataxie-zai-fa-xian-yuan-bao-zi-dong-ji-mi-du-zhang-luo-zhi-ji/" rel="alternate"></link><published>2017-03-07T13:52:00+00:00</published><updated>2017-03-07T13:52:00+00:00</updated><author><name>F. Geng</name></author><id>tag:www.newflaw.com,2017-03-07:/blog/articles/maths/on-the-discovery-of-density-fluctuation-in-cellular-automataxie-zai-fa-xian-yuan-bao-zi-dong-ji-mi-du-zhang-luo-zhi-ji/</id><summary type="html">&lt;p&gt;这个想法是在2017年3月7日凌晨，在伦敦的一台HP_Z600上初步实现的。整个发现的过程还是挺戏剧性的。&lt;/p&gt;
&lt;p&gt;背景：&lt;/p&gt;
&lt;p&gt;在这之前的一个月里我在MATLAB上断断续续从转移矩阵(transfer matrix)开始编起，发现没啥卵结果，然后在一篇文献上重新看到了Derrida Plot，也就是离散版本的Lyapunov Exponent，然后心中暗骂“Derrida这死脑筋干嘛要取平均值啊?"，并且在这样的心情中编写了derrida_general.m架构出了一个面向对象的流程结构，并且用协方差作为一个伪距离函数替代了平均值，获得了更多的信息。 这个时候的算法还是给了我一点小惊喜的，这直接导致我花了一个星期浏览它生成的Profile图片，大概收集了500条左右的有趣CA规则。但是浏览久了发现不对劲啊，这到底是我在筛选CA还是我的程序在筛选CA啊擦。（当然这个问题从我开始写算法时就一直有 …&lt;/p&gt;</summary><content type="html">&lt;p&gt;这个想法是在2017年3月7日凌晨，在伦敦的一台HP_Z600上初步实现的。整个发现的过程还是挺戏剧性的。&lt;/p&gt;
&lt;p&gt;背景：&lt;/p&gt;
&lt;p&gt;在这之前的一个月里我在MATLAB上断断续续从转移矩阵(transfer matrix)开始编起，发现没啥卵结果，然后在一篇文献上重新看到了Derrida Plot，也就是离散版本的Lyapunov Exponent，然后心中暗骂“Derrida这死脑筋干嘛要取平均值啊?"，并且在这样的心情中编写了derrida_general.m架构出了一个面向对象的流程结构，并且用协方差作为一个伪距离函数替代了平均值，获得了更多的信息。 这个时候的算法还是给了我一点小惊喜的，这直接导致我花了一个星期浏览它生成的Profile图片，大概收集了500条左右的有趣CA规则。但是浏览久了发现不对劲啊，这到底是我在筛选CA还是我的程序在筛选CA啊擦。（当然这个问题从我开始写算法时就一直有，也就是说算法的敏感度不错，真阳性基本都能检测到，但是假阳性也一堆一堆的，只有靠人工筛除）。&lt;/p&gt;
&lt;p&gt;思维跳跃如我，结合信息学最近上课学的多序列对齐（Multiple Sequence Alignment）猜想，能不能把CA的规则看成一条遗传信息，并且比较小的变异对其动力学性质的影响？ 一方面也希望能把MSA的想法应用进来，给出一个隐马尔可夫Profile，将会是一个非常漂亮的结果。随机变异过程倒是比较容易写，一两天就写完了，难在控制Alignment的深度，因为有些CA规则对变异一点都不敏感，18个比特你变掉三个它都无所谓，导致生成了巨大的团状Alignment，这个必须用算法进行控制。另一方面对这个树状图进行操作也需要一些新的编程技巧，以达到比较好的并行计算优化。 同时还花了三天帮室友修他的外星人，在EFI引导上栽了个大跟头，不过好在最后总算修好了Windows/Linux双系统。修系统无聊时就在琢磨把树状图显示出来，因为节点和连边一多起来Matlab的可视化就变得很慢，最后用vis.js做出了&lt;a href="http://www.newflaw.com/blog/wp-content/uploads/2017/03/fibre.png"&gt;“毛毛毛球”&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;然后我兴致冲冲地就去做随机测试了，结果......没卵用......仅仅发现了一些小的结论，比如B3/S23的18个比特里面有4个比特的变异是不太影响它的动力学的，其中两个的影响大一点(B7，S7的变异)，另外两个的变异几乎不产生影响（B8,S8），我称之为a2b2型。有趣/糟糕的是，a2b2型简直满地都是，但是和B3/S23的动力学性质没有半毛钱关系，我只好太息而弃。&lt;/p&gt;
&lt;p&gt;但是这里的另一个观察是，有一些强稳定的动力学可以经受7-8个比特的变异，给出～128左右的团簇。 我据此写了一个专门探测这些强稳规则的团簇边界，再找出混沌团簇的边界，以期在这两个团簇的交界处找到复杂的动力学性质，但是目前来看效果并不是特别好。&lt;/p&gt;
&lt;p&gt;故事：&lt;/p&gt;
&lt;p&gt;周一（03/06）早上正在改进团簇边界的算法，最后发现效果并不好，下午四点赶去上了一节动力系统的课程，结果老师貌似心情也不好一直在讲浅显/糟糕的废话，介绍了极限环理论，但是估计没有一个人听懂。他是学物理出身的，结果讲的时候一直在提系统论的概念，比如负反馈啊，延迟反馈啊，非线性啊，结果在座的这群生物狗估计一句都没听进去。。。然后老师提了个总结性问题：动力系统的极限环振荡解和谐振动的区别是？在座一片死机。 正解是：极限环震荡解的性质不依赖系统的初始状态，但是谐振子解的性质是虽初始状态而改变的，往深了讲是因为谐振子作为线性系统是保守的(Conservative)，而极限环往往是耗散(Dissipative)系统的渐进解，这本来是鲁棒性的一个极好体现，结果他对着生物狗强调了半天内部的数学结构。。。但是吧，非线性和生物之间到底有啥关系，的确也很难说请，老师对Hill Function的介绍还是很到位的，虽然他没能解释Hill的非线性和系统的鲁棒性到底有啥关系。&lt;/p&gt;
&lt;p&gt;上完了课肚子饿，不想回家，图书馆(Sci-Lib)浓浓的新生气息，编程没结果，死线就在周三，缺乏睡眠，你大概可以想像我到了一个多糟的境地。 为了防止把更多的时间浪费在方向不明的Coding上，我强迫自己在外面走走，恰巧ULU Student Hub 三楼在排练爵士乐，我就爬上去听了听，站在窗口看楼下过往的行人，放松放松：信号的本质是什么呢？伦敦的夜景我很少这样观察，远处WellcomeTrust的大楼闪烁着现代性，近处King's Church沉默在黑暗里。第一次，我站在这个高度俯瞰天天走过的Malet Street。 不断地搜索记忆，我想找出一丝线索： DerridaPlot之所以有用，FamilyTree之所以能被建构，背后靠的都是相关性函数，更进一步，FamilyTree比较的是同样的初始条件在两条相似的规则下的结果，并合并大量样本取一个协方差，但这个过程中所有的比特位都没有区别了。联想之前实践的平均场近似，只把0/1密度提取出来作为参数，而不关心具体的排列方式，这样处理CA显然是不妥当的，而且根据我之前的实验，如果把CA不断重新随机混合，得到的结果是非常符合平均场给出的结果的，但是一旦我去掉随机混合这个过程，平均场给出的近似和CA本身的动力学就没有半毛钱关系，这说明CA的空间不均匀性是非常核心的东西。同样的，如果对二维Ising不断进行混合/重排，其能量显然也不是不变的。取极端例子，本来是随机白噪音，假设重排成了一堆0和一堆1，显然能量有很大改变，所以Ising模型也是对空间不均匀性很敏感的。&lt;/p&gt;
&lt;p&gt;接下来就想怎么把CA的空间不均匀性抽象出来，于是想到了对同一个比特取一个延时摄影，并且取其平均为密度。本来这个操作的目的是移除闪光（Strobing）和高频闪烁的，但是很凑巧的是在真正Implement的过程中这个操作居然真的记录了空间不均性，也就是涨落。或者说，得到这个密度参数以后，只要观察这个密度在时间和空间上的统计行为，就能反映CA的动力学性质，而不取密度参直接用0/1（应该）是得不到这样的结果的，或者说会出一些别的问题。 当然这个算法也不完美，取0/1平均是有一定问题的，因为不同顺序相同密度的0/1序列蕴含的信息不一定相等，但是取0/1密度再做协方差的确是最简单最快的Implementation（相比共信息而言）。&lt;/p&gt;
&lt;p&gt;先写到这里，写完作业再来补。&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;</content><category term="maths"></category><category term="maths"></category><category term="story"></category><category term="chinese"></category></entry><entry><title>comment-board</title><link href="http://www.newflaw.com/blog/articles/list/comment-board/" rel="alternate"></link><published>2017-02-19T00:00:00+00:00</published><updated>2017-02-19T00:00:00+00:00</updated><author><name>F. Geng</name></author><id>tag:www.newflaw.com,2017-02-19:/blog/articles/list/comment-board/</id><summary type="html">&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;shouldsee,feng.geng.14"AT"ucl.ac.uk : wordpress revived after a ton of tinkering.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;shouldsee,feng.geng.14"AT"ucl.ac.uk : What works …&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;</summary><content type="html">&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;shouldsee,feng.geng.14"AT"ucl.ac.uk : wordpress revived after a ton of tinkering.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;shouldsee,feng.geng.14"AT"ucl.ac.uk : What works for biologists, may not work for computer scientists.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;shouldsee,feng.geng.14"AT"ucl.ac.uk : In reply to Bullet51.
BTW, I don’t seems to get email on this blog. Maybe github is a better place to talk if you can reach it. (https://github.com/MathAndAlgo/DiscussionBoard/issues).&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;shouldsee,feng.geng.14"AT"ucl.ac.uk : In reply to Bullet51.
That video looks really intriguing. You know what, the protein structure people was doing exactly the same thing! They inferred a empirical force-field from a collection of proteins and applied it to get sensible protein structures. (See https://salilab.org/modeller/)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;shouldsee,feng.geng.14"AT"ucl.ac.uk : In reply to Bullet51.
Haven’t spoken for long! Are you still studying GOL recently?&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Bullet51,w_w3333"AT"126.com : Particle Life. Looks like Biochem.
https://www.youtube.com/watch?v=Z_zmZ23grXE
https://github.com/HackerPoet/Particle-Life&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;shouldsee: Odour NMF https://flavourjournal.biomedcentral.com/articles/10.1186/2044-7248-3-S1-P3&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;A full introduction to probabilistic PCA by Lior Patcher.
https://liorpachter.wordpress.com/2014/05/26/what-is-principal-component-analysis/&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;In reply to shouldsee.
Inverse ising problems and probability flow
https://arxiv.org/abs/0906.4779&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;https://www.researchgate.net/publication/322713743_Convenient_Interface_to_Inverse_Ising_ConIII_A_Python_package_for_solving_maximum_entropy_models&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Animals:
The loyal geese: https://www.peta.org/blog/geese-kiss-goodbye/&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;In reply to shouldsee.
Image denoising by anisotropic diffusion: http://people.maths.ox.ac.uk/capdeboscq/HerbertAmann-Oxford-150609.pdf&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Graphics: R: http://zoonek2.free.fr/UNIX/48_R/04.html
中文生信社区： http://www.bio-info-trainee.com http://www.biotrainee.com:8080/&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;典故集：赵襄王学御/心不在马 ——《韩非子·喻老》
寧戚 齊桓公 淮南子&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;今日思考：如何回应一个不想和你谈话的人发出的谈话意向？
互补问题：如何在交流的时候避免对他人的轻视？&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;友情链接：Rosetta&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Useful Applied Stat Slides from ETH
https://stat.ethz.ch/education/semesters/ss2012/ams/slides/v7.2.pdf
“hmmscan VS hmmsearch” : https://cryptogenomicon.org/2011/05/27/hmmscan-vs-hmmsearch-speed-the-numerology/
Difference between logarithm of an expectation value and expectation value of a logarithm:
https://math.stackexchange.com/questions/21063/difference-between-logarithm-of-an-expectation-value-and-expectation-value-of-a&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Reinforcement learning:http://karpathy.github.io/2016/05/31/rl/
Williams1992, REINFORCE algorithm: http://www-anw.cs.umass.edu/~barto/courses/cs687/williams92simple.pdf
Andrej Karapathy writes excellent blogs for neural networks.
http://karpathy.github.io/
RNN and HDM: http://slideplayer.com/slide/8844792/
Cosma Shalizi
元胞自动机大神的非线性filtering
http://bactra.org/weblog/375.html
Some postdoc from DAMTP
https://rajeshrinet.github.io/blog/
Denoising: a diffusion-based approach
http://people.maths.ox.ac.uk/capdeboscq/HerbertAmann-Oxford-150609.pdf
Inverse ising problems and probability flow
https://arxiv.org/abs/0906.4779
https://www.researchgate.net/publication/322713743_Convenient_Interface_to_Inverse_Ising_ConIII_A_Python_package_for_solving_maximum_entropy_models&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;1.
Regex 配合 StringIO 简直Hacking神器
未来和过去的分界线，是当下。
Web icloud 用户体验差出了新高度。&lt;/p&gt;
&lt;p&gt;1.
Deconvolution: https://terpconnect.umd.edu/~toh/spectrum/Deconvolution.html
Image denoising by anisotropic diffusion: http://people.maths.ox.ac.uk/capdeboscq/HerbertAmann-Oxford-150609.pdf&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;/li&gt;
&lt;li&gt;辨而不辩，物理自明。&lt;/li&gt;
&lt;li&gt;权力的特征在于其不可违抗性 * 说服也是一种权力&lt;/li&gt;
&lt;li&gt;说服他人之心是本能，或者是原罪。&lt;/li&gt;
&lt;li&gt;感知并描述不可感知之物。&lt;/li&gt;
&lt;li&gt;对异己，第一反应是优越性。这种不对称的态度源自于感知的局限。（弥赛亚情节）&lt;/li&gt;
&lt;li&gt;从pip8.0升级到了pip9.0，现在好像必须加上“–user“参数才能安装Python单元了。&lt;/li&gt;
&lt;li&gt;Bogo sort 萌到飞起&lt;/li&gt;
&lt;li&gt;Sounds of sorting algorithms!!! //&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;魔性的排序算法可视化。（https://www.youtube.com/watch?v=kPRA0W1kECg）&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Today’s Point: Periodicity often coincides with complexity, but NOT always!
Breeders can successfully manage far more complex genetic interactions via phenotypic selection among fixed lines than even the most recent molecular approaches can explain. A breeder with a large, multi-national breeding and chemical company was recently overheard to say that they would have made much greater breeding progress if they hadn’t been so ‘distracted‘ by molecular biology. There can be too much information, and generally not enough relevant knowledge. “(Falk, Duane E. 2008)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;一个问题： Back propagation如果把所有output给出的gradient进行平均会给出什么样的动力学？
关于动力系统的那些奇技淫巧。「降维攻击」 https://sinews.siam.org/Details-Page/finding-emergent-low-dimensional-macroscopic-behavior-in-large-systems-of-many-coupled-dynamical-units#&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;晚上十点以后不编程，不算积分，不看电影。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Markovian Ising&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;1D ising-chain can be viewed as a markov process&lt;/li&gt;
&lt;li&gt;2D ising-chain can be viewed as a 1D ising chain with 2^H states where H is the height/collapsed dimension.&lt;/li&gt;
&lt;li&gt;Monte-carlo can be applied to estimate parameters for ising model.&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Monte-carlo can be applied to estimate parameters for markov process&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;2019-09-26 What does it mean to be friendly or not?&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Gooses &lt;img src="https://www.peta.org/wp-content/uploads/2016/08/Goodbye-Kiss-Geese.jpg" alt="Geese kiss-goodbye" /&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;python packaging: setup.py&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;I have been struggling with &lt;code&gt;python2 setup.py install&lt;/code&gt; not installing the package correctly even an "package.egg" is created under "/usr/local/lib/python2.7/dist-packages". After 2hr of searching I found out a simple solution:&lt;/p&gt;
&lt;p&gt;If you have a &lt;code&gt;can't iXXXrt XXX&lt;/code&gt; error. Try use &lt;code&gt;disutils.core.setup()&lt;/code&gt; instead of &lt;code&gt;setuptools.setup()&lt;/code&gt; in your "setup.py"&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Bioinf_diary:&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Dont expect biologist to appreciate the beauty/complexity of your code, nor the difference between different frameworks&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Take notes while biologists talk, translate them into program objectives, then throw them away. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Think about your data structures very carefully, because you will be the only one who is thinking about it.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;url_collection&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;YanBo Zhang:&lt;a href="http://zhangyanbo.leanote.com/post/%E5%85%83%E8%83%9E%E8%87%AA%E5%8A%A8%E6%9C%BA%E4%B8%AD%E4%BF%A1%E6%81%AF%E4%BC%A0%E9%80%92%E4%B8%8E%E8%87%AA%E5%A4%8D%E5%88%B6%E7%9A%84%E5%85%B3%E7%B3%BB" target="_blank"&gt;元胞自动机中信息传递与自复制的关系&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Merging statistics and nonlinear-dynamics:&lt;a href="http://www.nature.com/articles/srep01610"&gt;Chaotic Boltzmann Machine&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Methodology for classifying dynamics:&lt;a href="http://brain.cc.kogakuin.ac.jp/~kanamaru/Chaos/e/CMLGCM/"&gt;Intermittency in CML&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3&gt;曹刿与范文正公&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;乡人：“肉食者谋之，又何间焉？”&lt;/span&gt;

&lt;span class="err"&gt;刿：“肉食者鄙，未能远谋。”&lt;/span&gt;

&lt;span class="err"&gt;范文正公：“余常求古仁人之志，或异二者之为。居庙堂之高则忧其民，处江湖之远则忧其君。是进亦忧，退亦忧。然则何时而乐耶？其必曰：“先天下之忧而忧，后天下之乐而乐”乎。噫！微斯人，吾谁与归。”&lt;/span&gt;

&lt;span class="err"&gt;现在问题来了，当刿碰上范，会擦出怎样的火花呢？&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</content><category term="list"></category><category term="list"></category><category term="chinese"></category><category term="english"></category></entry><entry><title>两种0/1序列的熵</title><link href="http://www.newflaw.com/blog/articles/maths/liang-chong-01xu-lie-de-shang/" rel="alternate"></link><published>2017-02-18T22:39:00+00:00</published><updated>2017-02-18T22:39:00+00:00</updated><author><name>F. Geng</name></author><id>tag:www.newflaw.com,2017-02-18:/blog/articles/maths/liang-chong-01xu-lie-de-shang/</id><summary type="html">&lt;p&gt;两种定义方法&lt;/p&gt;
&lt;p&gt;1.考虑 s=[0,1]^d  如果d位里有a位为1,则考虑p=a/d  H(S)=p*log(p)+(1-p)log(p).&lt;/p&gt;
&lt;p&gt;2.考虑同样的s, 令 x=a/d …&lt;/p&gt;</summary><content type="html">&lt;p&gt;两种定义方法&lt;/p&gt;
&lt;p&gt;1.考虑 s=[0,1]^d  如果d位里有a位为1,则考虑p=a/d  H(S)=p*log(p)+(1-p)log(p).&lt;/p&gt;
&lt;p&gt;2.考虑同样的s, 令 x=a/d, p=p(x), H(S)=sum(p*log(p), for all s).&lt;/p&gt;
&lt;p&gt;受了张江老师的“&lt;a href="http://www.swarmagents.cn/detail.php?id=10822"&gt;两种熵&lt;/a&gt;”启发&lt;/p&gt;
&lt;h2&gt;毛毛毛球&lt;/h2&gt;
&lt;p&gt;&lt;img class="alignnone size-full wp-image-314" src="http://www.newflaw.com/blog/wp-content/uploads/2017/03/fibre.png" alt="fibre" width="816" height="1000" /&gt;&lt;/p&gt;
&lt;p&gt;思维跳跃如我，结合信息学最近上课学的多序列对齐（Multiple Sequence Alignment）猜想，能不能把CA的规则看成一条遗传信息，并且比较小的变异对其动力学性质的影响？ 一方面也希望能把MSA的想法应用进来，给出一个隐马尔可夫Profile，将会是一个非常漂亮的结果。随机变异过程倒是比较容易写，一两天就写完了，难在控制Alignment的深度，因为有些CA规则对变异一点都不敏感，18个比特你变掉三个它都无所谓，导致生成了巨大的团状Alignment，这个必须用算法进行控制。另一方面对这个树状图进行操作也需要一些新的编程技巧，以达到比较好的并行计算优化。 同时还花了三天帮室友修他的外星人，在EFI引导上栽了个大跟头，不过好在最后总算修好了Windows/Linux双系统。修系统无聊时就在琢磨把树状图显示出来，因为节点和连边一多起来Matlab的可视化就变得很慢，最后用vis.js做出了“毛毛毛球”。&lt;/p&gt;</content><category term="maths"></category><category term="maths"></category><category term="short"></category><category term="chinese"></category></entry><entry><title>应用_用回归图对符号动力学进行半系统的分类_论可测变换或动力系统与度量函数的耦合暨微扰论的拓展</title><link href="http://www.newflaw.com/blog/articles/maths/ying-yong-_yong-hui-gui-tu-dui-fu-hao-dong-li-xue-jin-xing-ban-xi-tong-de-fen-lei-_lun-ke-ce-bian-huan-huo-dong-li-xi-tong-yu-du-liang-han-shu-de-ou-he-ji-wei-rao-lun-de-tuo-zhan/" rel="alternate"></link><published>2017-02-15T11:35:00+00:00</published><updated>2017-02-15T11:35:00+00:00</updated><author><name>F. Geng</name></author><id>tag:www.newflaw.com,2017-02-15:/blog/articles/maths/ying-yong-_yong-hui-gui-tu-dui-fu-hao-dong-li-xue-jin-xing-ban-xi-tong-de-fen-lei-_lun-ke-ce-bian-huan-huo-dong-li-xi-tong-yu-du-liang-han-shu-de-ou-he-ji-wei-rao-lun-de-tuo-zhan/</id><summary type="html">&lt;p&gt;以相关性(correlation)为度量的回归图忠实地反映了基础元胞自动机(ECA)的动力学性质，可以很好地区分稳态和混沌态。&lt;/p&gt;
&lt;p&gt;我对Logistic Mapping做了简单的耦合推广，并应用回归图找到了处在混沌边界的参数，有趣的是这种推广系统也处在混沌边界。&lt;/p&gt;
&lt;p&gt;&lt;img class="alignnone size-full wp-image-253" src="http://www.newflaw.com/blog/wp-content/uploads/2017/02/demo_log_torus.jpg" alt="demo_log_torus" width="2409" height="436" /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img class="alignnone size-full wp-image-304" src="http://www.newflaw.com/blog/wp-content/uploads/2017/02/logistic__3-811_corrprofile.jpg" alt="logistic__3-811_corrprofile" width="1000" height="563" /&gt;&lt;/p&gt;
&lt;p&gt;讨论：二维元胞自动机是一个幻象，它并不比一维元胞高明到哪里去，对于Glider和Pattern的分类看起来没有发展壮大的希望。CA和物理学的联系目前还是太弱了，需要一些契机把CA爱好者引导到更有建设性的道路上。Wolfram对Rule110的阐释是很有insight的，但是他本人最后也认识到CA有一些内在的缺陷使其不能模拟神经网络。我希望Derrida Plot的复兴可以改变这一情况，这一工具允许人们更加系统地对自动机的动力学性质进行分类，而且和微扰论有很深的联系，希望有更多的人参与到这个研究里来。&lt;/p&gt;
&lt;p&gt;这里用一个二维BS元胞自动机为例子(B013468 …&lt;/p&gt;</summary><content type="html">&lt;p&gt;以相关性(correlation)为度量的回归图忠实地反映了基础元胞自动机(ECA)的动力学性质，可以很好地区分稳态和混沌态。&lt;/p&gt;
&lt;p&gt;我对Logistic Mapping做了简单的耦合推广，并应用回归图找到了处在混沌边界的参数，有趣的是这种推广系统也处在混沌边界。&lt;/p&gt;
&lt;p&gt;&lt;img class="alignnone size-full wp-image-253" src="http://www.newflaw.com/blog/wp-content/uploads/2017/02/demo_log_torus.jpg" alt="demo_log_torus" width="2409" height="436" /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img class="alignnone size-full wp-image-304" src="http://www.newflaw.com/blog/wp-content/uploads/2017/02/logistic__3-811_corrprofile.jpg" alt="logistic__3-811_corrprofile" width="1000" height="563" /&gt;&lt;/p&gt;
&lt;p&gt;讨论：二维元胞自动机是一个幻象，它并不比一维元胞高明到哪里去，对于Glider和Pattern的分类看起来没有发展壮大的希望。CA和物理学的联系目前还是太弱了，需要一些契机把CA爱好者引导到更有建设性的道路上。Wolfram对Rule110的阐释是很有insight的，但是他本人最后也认识到CA有一些内在的缺陷使其不能模拟神经网络。我希望Derrida Plot的复兴可以改变这一情况，这一工具允许人们更加系统地对自动机的动力学性质进行分类，而且和微扰论有很深的联系，希望有更多的人参与到这个研究里来。&lt;/p&gt;
&lt;p&gt;这里用一个二维BS元胞自动机为例子(B013468/S23,生命游戏是B3/S23),大致介绍一下Covariance Profile的具体操作办法，用一个常值分布随机取两个初始状态，计算它们的距离H(0),接下来用CA规则将两个初态分别迭代T次，并记录它们的轨迹。这样我们可以得到H(1),H(2),H(3)....H(T). 然后把上述操作重复N次。想象[H(1),H(2)]在平面内确定一个点，由于有N个样本，我们可以确定N个点，这时候我们可以计算H(1),H(2)的统计学关系(一开始我用的是相关性(Pearson Correlation),后面发现不够灵敏，于是换成了协方差(Covariance)&lt;/p&gt;
&lt;p&gt;&lt;img class="alignnone size-full wp-image-306" src="http://www.newflaw.com/blog/wp-content/uploads/2017/02/expanded6491tca.jpg" alt="expanded6491tca" width="735" height="661" /&gt;&lt;/p&gt;
&lt;p&gt;对于任选的H(t_a),H(t_b),我们都可以确定一个分布并且抽象成一个单值。将这些单值集合起来之后，我们就的到了刚刚看到的热相图。&lt;/p&gt;
&lt;p&gt;&lt;img class="alignnone size-full wp-image-308" src="http://www.newflaw.com/blog/wp-content/uploads/2017/02/collected6491tca.jpg" alt="collected6491tca" width="497" height="416" /&gt;&lt;/p&gt;
&lt;p&gt;(这里的单值用的都是协方差。)&lt;/p&gt;
&lt;p&gt;我的观察是，热相图的凹凸性可以很好地刻画原系统的动力学性质。可以看到这个热相图的对角线有一个凹扩散，这一般对应复杂的动力学（complex,相对于混沌 chaotic，稳定 stable而言）&lt;/p&gt;
&lt;p&gt;待续&lt;/p&gt;
&lt;p&gt;Comments: &lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Yanbo Zhang zhangyb1"AT"mail.ustc.edu.cn: Logistic Mapping 的想法非常有意思，似乎只用一个参数k就出现了Wolfram的四个基本类型。我在想，是否可以对离散元胞自动机做逆向的工作，从时空图直接反推到k，从而得到一个意义非常明确的序参量。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;shouldsee: 我现在的想法是完全用密度涨落来描述动力学性质，而不是用DerridaPlot。 把密度涨落抽象成几个Scalar的序参量应该是可行的，但是我还没有仔细考虑什么样的抽取办法是推广性最好的，因为目前这个抽取办法挺初等的，还缺少很多形式上的工作，只是从实用的角度发现还挺有用。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;</content><category term="maths"></category><category term="chinese"></category><category term="maths"></category></entry><entry><title>记录_论可测变换或动力系统与度量函数的耦合_暨微扰论的拓展_1</title><link href="http://www.newflaw.com/blog/articles/maths/ji-lu-_lun-ke-ce-bian-huan-huo-dong-li-xi-tong-yu-du-liang-han-shu-de-ou-he-_ji-wei-rao-lun-de-tuo-zhan-_1/" rel="alternate"></link><published>2017-02-14T16:57:00+00:00</published><updated>2017-02-14T16:57:00+00:00</updated><author><name>F. Geng</name></author><id>tag:www.newflaw.com,2017-02-14:/blog/articles/maths/ji-lu-_lun-ke-ce-bian-huan-huo-dong-li-xi-tong-yu-du-liang-han-shu-de-ou-he-_ji-wei-rao-lun-de-tuo-zhan-_1/</id><summary type="html">&lt;p&gt;2017/02/14 L，叁，F&lt;/p&gt;
&lt;p&gt;首先F抛出关于H1,H2和Derrida Plot的问题，询问在使用图论时原集合一般会内嵌在哪些度量空间(metric space)。&lt;/p&gt;
&lt;p&gt;L：抛出了对图论联通性和拓扑联通性之间的区别。L指出联通图可以自然导出一个最短路径（通过广度优先搜索），从而定义一个有离散拓扑的度量空间，但是图之联通不能导出最短路径对应的离散拓扑之联通。原因在于，由于这个拓扑是离散拓扑，所以这个拓扑对应的图显然不连通（只要图中的元素大于等于两个），而且由于道路/路径联通蕴含连通性，所以图也就不道路联通了 …&lt;/p&gt;</summary><content type="html">&lt;p&gt;2017/02/14 L，叁，F&lt;/p&gt;
&lt;p&gt;首先F抛出关于H1,H2和Derrida Plot的问题，询问在使用图论时原集合一般会内嵌在哪些度量空间(metric space)。&lt;/p&gt;
&lt;p&gt;L：抛出了对图论联通性和拓扑联通性之间的区别。L指出联通图可以自然导出一个最短路径（通过广度优先搜索），从而定义一个有离散拓扑的度量空间，但是图之联通不能导出最短路径对应的离散拓扑之联通。原因在于，由于这个拓扑是离散拓扑，所以这个拓扑对应的图显然不连通（只要图中的元素大于等于两个），而且由于道路/路径联通蕴含连通性，所以图也就不道路联通了。&lt;/p&gt;
&lt;p&gt;叁：单单给出一个集合(Set)并不能唯一地确定一个度量空间。额外地，我们需要赋予这个集合某些结构，比如说把它们按某种方法排成一排，计算距离就行了，但单单给出一个集合是不能确定度量空间的。&lt;/p&gt;
&lt;p&gt;L：总之，图论中最完全的信息，由边和顶点共同提供，可以人为地给图定义一些度量空间，但是这个度量在使用时要当心（叁：估计刘大师的意思是，图里的metric（比如由连接两点的最少的边的数量决定）并不是一个真正的metric space里的metric）。或者说是在套用metric space的结论时，要小心图论和拓扑空间之间术语的区别。&lt;/p&gt;
&lt;p&gt;叁：虽然我没有完全听懂，不过问题应该出在三角不等式 ，而不是连通性上吧？因为就算是真正的度量空间里面的开球也不一定是联通的。&lt;/p&gt;
&lt;p&gt;L：嗯其实是个metric，主要是连通性不一致可能会出错。譬如图论中的道路和拓扑空间就有点不一样。&lt;/p&gt;
&lt;p&gt;F：让我重新表述一下我的问题：
假设一个有限集合S 有一个测度 &lt;span class="math"&gt;\(\mu(S)\)&lt;/span&gt;，（L:为严谨，S的&lt;span class="math"&gt;\(\sigma\)&lt;/span&gt;代数是S的power set，&lt;span class="math"&gt;\(\mu: \sigma(S) \rightarrow [0,1]\)&lt;/span&gt;，而且&lt;span class="math"&gt;\(\mu\)&lt;/span&gt;满足并集相加），那么给定一个转移矩阵（Transition matrix ，也就是带强度的Edge matrix），令为 &lt;span class="math"&gt;\(\pi\)&lt;/span&gt; 。那令 &lt;span class="math"&gt;\(\mu_2=\pi * \mu_1\)&lt;/span&gt;，则&lt;span class="math"&gt;\(\pi\)&lt;/span&gt;是一个可测变换（这里的乘法定义是矩阵乘法）。根据马尔可夫链基本定理(THE FUNDAMENTAL THEOREM OF MARKOV CHAINS），如果 &lt;span class="math"&gt;\(\pi\)&lt;/span&gt; 的性质足够好，那么 &lt;span class="math"&gt;\(\pi\)&lt;/span&gt; 重复作用之后测度 &lt;span class="math"&gt;\(\mu\)&lt;/span&gt; 的是驻定的，但驻定这个条件还并不是最重要的。
现在有趣的是，S本身有一个内构的度量是汉明距离：&lt;span class="math"&gt;\(H(S_a,S_b)\)&lt;/span&gt;，（附：两条长度为n的有x个字符是不同的序列之间的汉明距离 &lt;span class="math"&gt;\(H=\frac{x}{n}\)&lt;/span&gt; ，当然除以n 不是必要的，只是一步正规化）。现在如果 &lt;span class="math"&gt;\(\pi\)&lt;/span&gt; 应一个有向图（directed graph），也就是说每个元素只能有一个下家，且定义这条边强度为1,那么给出 &lt;span class="math"&gt;\( a_2=\pi(a_1)\)&lt;/span&gt;, &lt;span class="math"&gt;\(b_2=\pi(b_2)\)&lt;/span&gt;，现在我们考察 &lt;span class="math"&gt;\(H(a_1,b_1), H(a_2,b_2)\)&lt;/span&gt; 之间的关系 （简称 &lt;span class="math"&gt;\(H_1,H_2\)&lt;/span&gt; ）。
联系微扰理论(perturbation theory)，讨论同一个微分方程 &lt;span class="math"&gt;\(\frac{dx}{dt} = f(x)\)&lt;/span&gt;，从x0开始会给出一条轨迹x(t)，从x0+e会给出另一条轨迹x’(t)，通过考察 &lt;span class="math"&gt;\(\frac{d(|x' - x|)}{dt} =g(|x' -x|)\)&lt;/span&gt; 可以得出系统的复杂度/渐进稳定性（这里g可以从f和x0导出）。注意到我们使用了一个度量|x’-x|，在微分动力系统中这个度量常常是L2-norm，也就是欧几里得距离，也就是说，我们考察的是L2度量在微分动力系统下的行为，以理解该动力系统的混沌性。相应的，在前一个例子中，我们考察的是汉明度量在可测变换下的行为，理论上这可以体现出该可测变换的混沌性。但是需要注意的是，经典微扰理论关心的是|x’-x|极小时的行为，离散扰动理论却被迫关心H1和H2之间的统计联系，因为对H1取极小并不是一个极为自然的选择。&lt;/p&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</content><category term="maths"></category><category term="chinese"></category><category term="maths"></category></entry><entry><title>重整化，基态， 黑帆</title><link href="http://www.newflaw.com/blog/articles/thoughts/zhong-zheng-hua-ji-tai-hei-fan/" rel="alternate"></link><published>2017-02-08T23:38:00+00:00</published><updated>2017-02-08T23:38:00+00:00</updated><author><name>F. Geng</name></author><id>tag:www.newflaw.com,2017-02-08:/blog/articles/thoughts/zhong-zheng-hua-ji-tai-hei-fan/</id><summary type="html">&lt;p&gt;-Don't deem a paper incorrect just because you don't understand it.&lt;/p&gt;
&lt;p&gt;-讨论了《黑帆》里的一些寓意&lt;/p&gt;
&lt;p&gt;-讨论了DMRG（密度矩阵重整化群）作为“以小见大”的一个手法的一些特征。&lt;/p&gt;
&lt;p&gt;最近的娱乐活动主要是在看黑帆(Black Sails)这部剧，亚马逊Prime上有免费看所以追的很勤快。对比权利的游戏和西部世界 …&lt;/p&gt;</summary><content type="html">&lt;p&gt;-Don't deem a paper incorrect just because you don't understand it.&lt;/p&gt;
&lt;p&gt;-讨论了《黑帆》里的一些寓意&lt;/p&gt;
&lt;p&gt;-讨论了DMRG（密度矩阵重整化群）作为“以小见大”的一个手法的一些特征。&lt;/p&gt;
&lt;p&gt;最近的娱乐活动主要是在看黑帆(Black Sails)这部剧，亚马逊Prime上有免费看所以追的很勤快。对比权利的游戏和西部世界，黑帆的叙事更加古典，加之海盗的叙事线对我比较新颖，所以看得异常入迷。这部剧的好处在于张力极强，在一个极小的格局中浓缩进了高强度的冲突。与权利的游戏随意杀主角形成对比的是，黑帆的人物有明显的层级性，随之赋予了一定的英雄主义情节。但这不妨碍它呈现人性的冲突——是取岛屿的整体大义，还是取报仇的一己之快？是领导船员走一条风险大的道路，还是做一些稳稳当当但是不会亏本的买卖？当船员与船长的目标相脱节，矛盾冲突又将如何调和？短线和长线相互博弈，期望和务实前后矛盾。黑帆给我们展现是一个赤裸裸的罗生门，在这里所有人都自以为掌控着命运，最终又陷入冲突而失去一切反抗的资源。&lt;/p&gt;
&lt;p&gt;这些道理被巧妙地隐藏在黑帆的叙事里：第一季Flint船长在追击Andromache时与Billy进行的讨论尤其精要：我们以为猎物是在北边的，所以我们朝着北边前进以期猎杀，但是猎物的选择我们是不知道的，它甚至可能调转航向以其与我们错身而过;它甚至也可能不在北边，到时候我们将面对一片空荡荡的海面。（大意）当然最后这些更差的情况都没有发生，而Andromache确实走了最普通的一个选择。但Flint作为船长，其远见和策划的能力都是远高于当时的Billy的，但这个能力也需要有船员来执行，否则再多的推断也无法保证Flint自己的生存。换句话说，仓禀足而知礼节，但知礼节本身不能解决吃饭问题，随时面临挨饿的危险。但知礼节者之所以不再陷入挨饿的困境，是因为他能够调控饿肚子人的行为来解决自己的吃饭问题，而一旦饿肚子的人顿悟了礼节的重要性，那么两者必然陷入权利的争夺。&lt;/p&gt;
&lt;p&gt;&lt;img width="45%" src="http://www.newflaw.com/blog/wp-content/uploads/2017/02/screenshot-from-2017-02-05-18-40-53.png" alt="Pictures from Black Sails"&gt;&lt;/img&gt;
&lt;img width="45%" src="http://www.newflaw.com/blog/wp-content/uploads/2017/02/screenshot-from-2017-02-05-18-41-08.png" alt="Pictures from Black Sails"&gt;&lt;/img&gt;&lt;/p&gt;
&lt;p&gt;(Pictures from "Black Sails")&lt;/p&gt;
&lt;p&gt;道理说起来都是简单的，家家却都有本难念的经。冲突来自于各个琐碎的方面而不遵从任一统一的名字。每个人会基于自己的背景作出自己的判断，却又被迫与他人协调以取得成果。没有任何判断是准确且必然的，人们所能控制的仅仅是尽量减少前后矛盾的判断。然而，每个人对待矛盾的态度又是由其背景决定的。&lt;/p&gt;
&lt;p&gt;剧中还用到了一些有意思的叙事手法。在Flint还在海军服役的时候，有一件意外极大地影响了他的前程：Nassau的执政官被当地民众颠覆了，导致Flint和Hamilton赦免Nassau的计划彻底泡汤。然而，当Flint自己执掌海盗的时候，他与执政者的关系也是糟糕得丝毫不容赦免的可能。这个循环的叙事导致Flint既是颠覆的实施者（之后）又是颠覆的受难者（之前）。滴水不漏的叙事硬生生地刻画出了生存的艰难，文明的艰难。赦免的初衷是好的，但却失去了支配的力量。文明的初衷是好的，但代价是拱手让出那些更现实的利益，并承担更大的风险，而这风险只有通过必要的恶才能解除。&lt;/p&gt;
&lt;p&gt;学术方面在接触作为一种数值模拟方法的DMRG，糟糕的是几乎所有的文献都是用bra-ket和线性代数写就的，对于只会用偏微分处理热力学模型的我是一个比较大的挑战。DMRG的最大应用在于寻找系统在大尺度上的一个基态，而且其效果和蒙特卡洛有得一拼。这应该是我第一次实战接触统计物理了，希望在解决这个问题后能够把微观-&amp;gt;宏观的这套哲学运用到其他的问题上。&lt;/p&gt;
&lt;p&gt;简要介绍一下DMRG，多体系统可以用一个波函数（即一个联合概率分布）来描述，概率最大的那个波函数即是系统的基态。但是与其NRG直接寻找子系统的基态不同的是，DMRG寻找 子系统+少量微观元素 的联合系统的一个基态，再将原来的子系统投射到这个基态中占主导的那些子系统波函数组分上。具体的算法还在钻研，希望能够尽快重复出Nishino_1995做出的2D伊辛的结果。&lt;/p&gt;
&lt;p&gt;&lt;img class="alignnone size-full wp-image-176" src="http://www.newflaw.com/blog/wp-content/uploads/2017/02/dmrg_nishino1995.png" alt="dmrg_nishino1995.png" width="599" height="449" /&gt;&lt;/p&gt;
&lt;p&gt;（摘自Nishino 1995, DMRG method for 2D classical Models）&lt;/p&gt;
&lt;p&gt;这个由小见大的过程真的是很有意思。还需要注意的是，在相变临界点附近，DMRG的精度会下降很多，因为这个时候很难找到占“主导”的子系统波函数，也就是说，几乎所有波函数都是可能的。或许可以通过某些数学来解出这种本征值均等的状况何时出现，以期严格解出相变点，但是这要等到彻底理解算法以后了。&lt;/p&gt;
&lt;p&gt;一些别的碎碎念：两个蛋白质结合，是否意味着他们降落到一个基态上了呢？那么在结合之前，他们岂不是在亚稳态？如何用DMRG处理生物中明显的层级特征呢？蛋白质相互作用能不能用算符来建模呢？更确切地说，如何建模才能收集不同层次的信息？在缺乏对称性的情况下，如何改良原来的方法呢？&lt;/p&gt;
&lt;p&gt;路漫漫其修远兮，但这不成为停下脚步的理由。&lt;/p&gt;
&lt;p&gt;2017/02/08
瓶子&lt;/p&gt;
&lt;p&gt;PS: 有一个跟生物研究相关的小游戏&lt;a href="http://phylo.cs.mcgill.ca/"&gt;Phylo&lt;/a&gt;，觉得好玩的可以在楼下讨论。&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;</content><category term="thoughts"></category><category term="chinese"></category><category term="thoughts"></category></entry><entry><title>About Me</title><link href="http://www.newflaw.com/blog/articles/misc/about-me/" rel="alternate"></link><published>2016-11-25T00:00:00+00:00</published><updated>2016-11-25T00:00:00+00:00</updated><author><name>F. Geng</name></author><id>tag:www.newflaw.com,2016-11-25:/blog/articles/misc/about-me/</id><summary type="html">&lt;h3&gt;Overview&lt;/h3&gt;
&lt;p&gt;I am a computational biologist interested in applying machine learning to functional genomics datasets. Using Python2 as my primary language, I developed a expectation-maximisation …&lt;/p&gt;</summary><content type="html">&lt;h3&gt;Overview&lt;/h3&gt;
&lt;p&gt;I am a computational biologist interested in applying machine learning to functional genomics datasets. Using Python2 as my primary language, I developed a expectation-maximisation program to auto-classify genes into synergistic groups.&lt;/p&gt;
&lt;p&gt;I am also broadly interested in structural biology and molecular dynamics, including:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;cellular automata&lt;/li&gt;
&lt;li&gt;renormalisation / coarse-graining&lt;/li&gt;
&lt;li&gt;inverse-ising problem&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;On days outside coding, I spend my time playing music and building electronic devices. My favourite creation so far is a dispersive spectrometer.&lt;/p&gt;
&lt;p&gt;Email: feng.geng.14@ucl.ac.uk&lt;/p&gt;</content><category term="misc"></category></entry></feed>